var ConcatenateScene;(()=>{"use strict";var e={631:()=>{HTMLElement.prototype.removeAllChildren=function(){for(;this.hasChildNodes();)this.firstChild&&this.removeChild(this.firstChild)},HTMLElement.prototype.makeCover=function(){this.style.display="flex",this.style.width="100%",this.style.height="100%",this.style.position="absolute",this.style.top="0",this.style.left="0"}},28:(e,t,n)=>{n.d(t,{debounceFactory:()=>r,isMobileBrowser:()=>i});const s=new Map;function i(){return/Android|iPhone/i.test(navigator.userAgent)}function r(e,t){let n;return function(){const s=window,i=arguments;clearTimeout(n),n=window.setTimeout((()=>e.apply(s,i)),t)}}new Map,window.addEventListener("keydown",(e=>{for(const t of s)e.code===t[0]&&t[1].forEach((t=>t(e)))}))},930:(e,t,n)=>{n.d(t,{Layer:()=>s}),n(631),n(936);class s{element;priority;backgroundStyle;backgroundImage;filter;classList;cursor;onClick;onMouseOver;onMouseDown;onMouseUp;constructor({priority:e,backgroundStyle:t,backgroundImage:n,filter:i,cursor:r,onClick:o,onMouseOver:l,onMouseDown:a,onMouseUp:c,classList:h}){this.priority=e,this.filter=i,this.backgroundStyle=t,this.backgroundImage=n,this.cursor=r,this.classList=h,this.onClick=o,this.onMouseOver=l,this.onMouseDown=a,this.onMouseUp=c,this.element=s.getLayerElement(this,this.priority,this.classList,this.backgroundStyle,this.backgroundImage,this.filter,this.cursor,this.onClick,this.onMouseOver,this.onMouseDown,this.onMouseUp)}setParent(e){if(e.insertAdjacentElement("beforeend",this.element),this.element.parentElement&&this.element.parentElement.id){const e=this.element.parentElement.id,t=this.element.parentElement.getElementsByClassName("layer").length-1;this.element.id=`layer${t}${e.capitalizeFirstLetter()}`}}setAsMainLayer(e){if(e.insertAdjacentElement("beforeend",this.element),this.element.parentElement&&this.element.parentElement.id){const e=this.element.parentElement.id;this.element.id=`mainLayer${e.capitalizeFirstLetter()}`}}static getLayerElement(e,t,n,s,i,r,o,l,a,c,h){const m=document.createElement("div");return m.classList.add(...n||[]),m.classList.add("layer"),m.makeCover(),m.style.zIndex=t>0?t.toString():"0",s&&(m.style.background=s),r&&(m.style.filter=r),o&&(m.style.cursor=o),l&&m.addEventListener("click",(()=>{l(e)})),a&&m.addEventListener("mouseover",(()=>{a(e)})),c&&m.addEventListener("mousedown",(()=>{c(e)})),h&&m.addEventListener("mouseup",(()=>{h(e)})),i&&this.setLayerBackgroundImage(m,i),m}static setLayerBackgroundImage(e,t){const n=document.createElement("img");n.src=t,n.style.userSelect="none",n.style.maxWidth="100%",n.style.height="auto",n.makeCover(),e.insertAdjacentElement("afterbegin",n)}}},19:(e,t,n)=>{function s(e=0,t=0,n=100){return Math.max(t,Math.min(e,n))}n.d(t,{clamp:()=>s})},931:(e,t,n)=>{n.d(t,{Scene:()=>i});var s=n(930);class i{container;element;layers;components;mainLayer;mainLayerConfig;constructor({container:e,layers:t,components:n,mainLayerConfig:s}){this.container=e,this.mainLayerConfig=s,this.layers=t,this.components=n||[],this.element=document.createElement("div"),this.components.forEach((e=>this.element.insertAdjacentElement("beforeend",e.container)))}async build(){this.container.classList.add("scene-container"),this.element.classList.add("scene"),this.setupLayers(),this.setElementStyle(),this.container.insertAdjacentElement("beforeend",this.element),this.components.forEach((async e=>await e.build(this)))}getMainLayer(){}get sceneCounter(){return this.container.querySelectorAll(`#${this.container.id} > .scene`).length}setupLayers(){this.container.id?this.element.id=`${this.container.id}${this.sceneCounter}`:(this.container.id=`sceneContainer${this.container.getElementsByClassName("scene-container").length}`,this.element.id=`scene${this.sceneCounter}`),this.layers.forEach((e=>{e.setParent(this.element)})),this.mainLayerConfig?(this.mainLayer=new s.Layer({...this.mainLayerConfig,priority:999}),this.mainLayer.setAsMainLayer(this.element)):(this.mainLayer=new s.Layer({priority:999}),this.mainLayer.setAsMainLayer(this.element))}setElementStyle(){this.container.style.position="relative",this.container.style.flexWrap="wrap",this.element.style.position="relative",this.element.style.display="flex",this.element.style.width="100vw",this.element.style.height="100vh",this.element.style.left="0",this.element.style.top="0",this.element.style.overflow="hidden"}}},936:()=>{String.prototype.isNullOrEmpty=function(){return"string"!=typeof this&&!this&&""!==this},String.prototype.truncate=function(e,t="..."){return(this.length>e?this.substring(0,e)+t:this).toString()},String.prototype.removeAccents=function(){return this.normalize("NFD").replace(/[\u0300-\u036f]/g,"")},String.prototype.capitalizeFirstLetter=function(){return"string"!=typeof this?"":this.charAt(0).toUpperCase()+this.substring(1)},String.prototype.zeroBefore=function(){return this.padStart(2,"0")}},676:(e,t,n)=>{var s,i,r,o;n.d(t,{DIRECTION_REFERENCE:()=>i}),function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENTAGE=1]="PERCENTAGE"}(s||(s={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(i||(i={})),function(e){e[e.FROM_TOP=0]="FROM_TOP",e[e.FROM_BOTTOM=1]="FROM_BOTTOM"}(r||(r={})),function(e){e[e.R=0]="R",e[e.G=1]="G",e[e.B=2]="B",e[e.A=3]="A"}(o||(o={}))}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{n.r(s),n.d(s,{ConcatenateScene:()=>o});var e=n(28),t=n(19),i=n(931),r=n(676);class o extends i.Scene{scenes=[];index=0;currentSceneClassName="show";direction;constructor(e){super({container:e.container,layers:[],components:e.components||[]}),this.direction=e.direction}async build(){await super.build(),this.container.classList.add("scene-container","concatenate-scene"),this.element.style.flexWrap="wrap",this.setupElement(),this.setupScenes(),this.scenes.forEach((async e=>await e.build()))}push(e){e&&(Array.isArray(e)||(e=[e]),e.forEach(((e,t)=>{this.scenes.push(e),0===t&&this.scenes[0].element.classList.add(this.currentSceneClassName)})))}pushSceneByConfig(e){e&&(Array.isArray(e)||(e=[e]),e.forEach(((e,t)=>{this.scenes.push(new i.Scene({...e,container:this.element})),0===t&&this.scenes[0].element.classList.add(this.currentSceneClassName)})))}get length(){return this.scenes.length}isFirstScene(){return 0===this.index}isLastScene(){return this.index===this.length-1}prev(){this.goTo(this.index-1)}next(){this.goTo(this.index+1)}goTo(e){this.setCurrentSceneByIndex(e),this.direction===r.DIRECTION_REFERENCE.HORIZONTAL?this.element.scrollTo({top:0,left:window.innerWidth*e,behavior:"smooth"}):this.element.scrollTo({top:window.innerHeight*e,left:0,behavior:"smooth"})}setCurrentSceneByIndex(e){e=(0,t.clamp)(e,0,this.scenes.length-1),Array.from(this.element.getElementsByClassName(this.currentSceneClassName)).forEach((e=>{e.classList.remove(this.currentSceneClassName)})),this.scenes[e].element.classList.add(this.currentSceneClassName),this.index=e}setupScenes(){this.scenes.forEach((e=>{e.element.style.flex="none",e.element.style.scrollSnapAlign="center"}))}setupElement(){this.element.style.scrollBehavior="smooth",this.element.style.display="flex",this.direction===r.DIRECTION_REFERENCE.HORIZONTAL?this.setupElementHorizontal():this.setupElementVertical(),this.element.style.flexWrap="nowrap",this.element.style.scrollSnapAlign="center",this.element.style.justifyContent="baseline",this.element.style.alignItems="center"}setupElementHorizontal(){this.element.style.flexDirection="column",this.element.style.scrollSnapType="x mandatory";const t=(0,e.debounceFactory)((()=>{this.setCurrentSceneByIndex(Math.round(this.element.scrollLeft/window.innerWidth))}),500);this.element.addEventListener("scroll",(()=>{t()})),(0,e.isMobileBrowser)()?(this.element.style.overflowX="auto",this.element.style.overflowY="hidden"):(this.element.style.overflowX="hidden",this.element.style.overflowY="hidden")}setupElementVertical(){this.element.style.flexDirection="row",this.element.style.scrollSnapType="y mandatory";const t=(0,e.debounceFactory)((()=>{this.setCurrentSceneByIndex(Math.round(this.element.scrollTop/window.innerHeight))}),500);this.element.addEventListener("scroll",(()=>{t()})),(0,e.isMobileBrowser)()?(this.element.style.overflowX="hidden",this.element.style.overflowY="auto"):(this.element.style.overflowX="hidden",this.element.style.overflowY="hidden")}}})(),ConcatenateScene=s})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TThLLFVBQVksU0FFL0JuTCxLQUFLb0MsUUFBUS9CLE1BQU02SyxVQUFZLFNBQy9CbEwsS0FBS29DLFFBQVEvQixNQUFNOEssVUFBWSxTQUVuQyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vRE9NRXh0ZW5zaW9ucy50cyIsIndlYnBhY2s6Ly8vLi9ET01Ub29scy50cyIsIndlYnBhY2s6Ly8vLi9MYXllci50cyIsIndlYnBhY2s6Ly8vLi9NYXRoVG9vbHMudHMiLCJ3ZWJwYWNrOi8vLy4vU2NlbmUudHMiLCJ3ZWJwYWNrOi8vLy4vU3RyaW5nRXh0ZW5zaW9ucy50cyIsIndlYnBhY2s6Ly8vLi90eXBlcy50cyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vLy4vQ29uY2F0ZW5hdGVTY2VuZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgSFRNTEVsZW1lbnQge1xyXG4gIHJlbW92ZUFsbENoaWxkcmVuKCk6IHZvaWQ7XHJcbiAgbWFrZUNvdmVyKCk6IHZvaWQ7XHJcbn1cclxuXHJcbkhUTUxFbGVtZW50LnByb3RvdHlwZS5yZW1vdmVBbGxDaGlsZHJlbiA9IGZ1bmN0aW9uICgpIHtcclxuICB3aGlsZSAoIHRoaXMuaGFzQ2hpbGROb2RlcygpICkge1xyXG4gICAgaWYgKCB0aGlzLmZpcnN0Q2hpbGQgKSB7XHJcbiAgICAgIHRoaXMucmVtb3ZlQ2hpbGQoIHRoaXMuZmlyc3RDaGlsZCApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuSFRNTEVsZW1lbnQucHJvdG90eXBlLm1ha2VDb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgdGhpcy5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICB0aGlzLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICB0aGlzLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICB0aGlzLnN0eWxlLnRvcCA9ICcwJztcclxuICB0aGlzLnN0eWxlLmxlZnQgPSAnMCc7XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9pbnQyRCwgcmVnZXhOdW1iZXJQYXR0ZXJuIH0gZnJvbSAnLi9NYXRoVG9vbHMnO1xyXG5pbXBvcnQgeyBDb2xsaXNpb25EaXJlY3Rpb25DaGVjaywgQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmV4cG9ydCB0eXBlIEtleWJvYXJkRXZlbnRDYWxsYmFjayA9ICggZXZ0OiBLZXlib2FyZEV2ZW50ICkgPT4gdm9pZDtcclxuXHJcbmV4cG9ydCBjb25zdCBkaWN0S2V5c0J5QWN0aW9uID0gbmV3IE1hcDxzdHJpbmcsIEtleWJvYXJkRXZlbnRDYWxsYmFja1tdPigpO1xyXG5leHBvcnQgZnVuY3Rpb24gYWRkQWN0aW9uS2V5KCBrZXk6IHN0cmluZywgZXZlbnQ6IEtleWJvYXJkRXZlbnRDYWxsYmFjayApIHtcclxuICBpZiAoIGRpY3RLZXlzQnlBY3Rpb24uaGFzKCBrZXkgKSApIHtcclxuICAgIGRpY3RLZXlzQnlBY3Rpb24uc2V0KCBrZXksIFtldmVudCwgLi4uZGljdEtleXNCeUFjdGlvbi5nZXQoIGtleSApIV0gKVxyXG4gIH0gZWxzZSB7XHJcbiAgICBkaWN0S2V5c0J5QWN0aW9uLnNldCgga2V5LCBbZXZlbnRdIClcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0VsZW1lbnRDb2xsaXNpb24oIGVsZW1lbnQxOiBIVE1MRWxlbWVudCwgZWxlbWVudDI6IEhUTUxFbGVtZW50ICk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IHJlY3QxID0gZWxlbWVudDEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgY29uc3QgcmVjdDIgPSBlbGVtZW50Mi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgcmV0dXJuICEoXHJcbiAgICByZWN0MS50b3AgPiByZWN0Mi5ib3R0b20gfHxcclxuICAgIHJlY3QxLnJpZ2h0IDwgcmVjdDIubGVmdCB8fFxyXG4gICAgcmVjdDEuYm90dG9tIDwgcmVjdDIudG9wIHx8XHJcbiAgICByZWN0MS5sZWZ0ID4gcmVjdDIucmlnaHRcclxuICApO1xyXG59XHJcblxyXG4vLy8gR2V0IHRoZSBkZWZhdWx0IGF0dHJpYnV0ZXMgZnJvbSB0aGUgdGFyZ2V0IGVsZW1lbnRcclxuLy8vIElmIGhhdmUgbm90IGRlZmF1bHQgYXR0cmlidXRlIHdpdGggdGhpcyBAYXR0cmlidXRlTmFtZSBvbiBtYXAgd2lsbCBzZXQgdGhlIGN1cnJlbnQgYXR0cmlidXRlIGFzIGRlZmF1bHRcclxuLy8vIElmIGhhdmUgbm90IGRlZmF1bHQgYXR0cmlidXRlIHdpdGggdGhpcyBAYXR0cmlidXRlTmFtZSB3aWxsIHJldHVybiBhbiBlbXB0eSBzdHJpbmdcclxuZXhwb3J0IGNvbnN0IG1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50ID0gbmV3IE1hcDxIVE1MRWxlbWVudCwgTWFwPHN0cmluZywgc3RyaW5nPj4oKTtcclxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRBdHRyaWJ1dGVGb3JUYXJnZXQoIHRhcmdldDogSFRNTEVsZW1lbnQsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyApOiBzdHJpbmcge1xyXG4gIGlmICggIW1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LmhhcyggdGFyZ2V0ICkgKSB7XHJcbiAgICBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5zZXQoIHRhcmdldCwgbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKSApO1xyXG4gIH1cclxuXHJcbiAgbGV0IHJlc3VsdDogc3RyaW5nID0gJyc7XHJcbiAgY29uc3QgZGVmYXVsdEF0dHJpYnV0ZVZhbHVlc0J5TmFtZSA9IG1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LmdldCggdGFyZ2V0ICkhO1xyXG4gIGNvbnN0IHRhcmdldERlZmF1bHRBdHRyaWJ1dGUgPSAhZGVmYXVsdEF0dHJpYnV0ZVZhbHVlc0J5TmFtZS5oYXMoIGF0dHJpYnV0ZU5hbWUgKSA/IHRhcmdldC5nZXRBdHRyaWJ1dGUoIGF0dHJpYnV0ZU5hbWUgKSA6IGRlZmF1bHRBdHRyaWJ1dGVWYWx1ZXNCeU5hbWUuZ2V0KCBhdHRyaWJ1dGVOYW1lICkhO1xyXG5cclxuICByZXN1bHQgPSB0YXJnZXREZWZhdWx0QXR0cmlidXRlID8gdGFyZ2V0RGVmYXVsdEF0dHJpYnV0ZSA6ICcnO1xyXG4gIHNldERlZmF1bHRBdHRyaWJ1dGVGb3JUYXJnZXQoIHRhcmdldCwgYXR0cmlidXRlTmFtZSwgcmVzdWx0ICk7XHJcblxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXREZWZhdWx0QXR0cmlidXRlRm9yVGFyZ2V0KCB0YXJnZXQ6IEhUTUxFbGVtZW50LCBhdHRyaWJ1dGVOYW1lOiBzdHJpbmcsIG5ld0RlZmF1bHRBdHRyaWJ1dGU6IHN0cmluZyApOiB2b2lkIHtcclxuICBpZiAoICFtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5oYXMoIHRhcmdldCApICkge1xyXG4gICAgbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuc2V0KCB0YXJnZXQsIG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCkgKTtcclxuICB9XHJcblxyXG4gIG1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LmdldCggdGFyZ2V0ICkhLnNldCggYXR0cmlidXRlTmFtZSwgbmV3RGVmYXVsdEF0dHJpYnV0ZSApO1xyXG59XHJcblxyXG4vLy8gRGl2aWRlIG8gZWxlbWVudG8gQHRhcmdldCBlbSA5IFwicXVhZHJhZG9zXCIgaWd1YWlzIGUgcmV0b3JuYSBlbSBxdWFpcyBxdWFkcmFkb3MgbyBkcmFnZ2FibGUgZXN0w6EgY29saWRpbmRvIGNvbSBvIHRhcmdldFxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29sbGlzaW9uRGlyZWN0aW9uKCBkcmFnZ2FibGU6IEhUTUxFbGVtZW50LCB0YXJnZXQ6IEhUTUxFbGVtZW50ICk6IENvbGxpc2lvbkRpcmVjdGlvbkNoZWNrIHtcclxuICBjb25zdCByZWN0MSA9IGRyYWdnYWJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICBjb25zdCByZWN0MiA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgY29uc3QgaXNUb3AgPSByZWN0MS5ib3R0b20gPiByZWN0Mi50b3AgJiYgcmVjdDEudG9wIDwgcmVjdDIudG9wICsgcmVjdDIuaGVpZ2h0IC8gMztcclxuICBjb25zdCBpc1JpZ2h0ID0gcmVjdDEubGVmdCA8IHJlY3QyLnJpZ2h0ICYmIHJlY3QxLnJpZ2h0ID4gcmVjdDIucmlnaHQgLSByZWN0Mi53aWR0aCAvIDM7XHJcbiAgY29uc3QgaXNDZW50ZXIgPSByZWN0MS50b3AgPCByZWN0Mi5ib3R0b20gJiYgcmVjdDEuYm90dG9tID4gcmVjdDIudG9wICYmIHJlY3QxLmxlZnQgPCByZWN0Mi5yaWdodCAmJiByZWN0MS5yaWdodCA+IHJlY3QyLmxlZnQ7XHJcbiAgY29uc3QgaXNCb3R0b20gPSByZWN0MS50b3AgPCByZWN0Mi5ib3R0b20gLSByZWN0Mi5oZWlnaHQgLyAzICYmIHJlY3QxLmJvdHRvbSA+IHJlY3QyLmJvdHRvbSAtIHJlY3QyLmhlaWdodCAvIDM7XHJcbiAgY29uc3QgaXNMZWZ0ID0gcmVjdDEucmlnaHQgPiByZWN0Mi5sZWZ0ICYmIHJlY3QxLmxlZnQgPCByZWN0Mi5sZWZ0ICsgcmVjdDIud2lkdGggLyAzO1xyXG5cclxuICByZXR1cm4geyB0b3A6IGlzVG9wLCByaWdodDogaXNSaWdodCwgY2VudGVyOiBpc0NlbnRlciwgYm90dG9tOiBpc0JvdHRvbSwgbGVmdDogaXNMZWZ0IH07XHJcbn1cclxuXHJcbi8vLyByZXR1cm4gdGhlIGRpc3RhbmNlIGZyb20gdGhlIGNlbnRlciBvZiB0aGUgZHJhZ2dhYmxlIHRvIHRoZSBjZW50ZXIgb2YgdGhlIHRhcmdldCBlbGVtZW50IGZyb20gZWFjaCBib3JkZXIgXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREaXN0YW5jZUZyb21Cb3JkZXIoIGRyYWdnYWJsZTogSFRNTEVsZW1lbnQsIHRhcmdldDogSFRNTEVsZW1lbnQgKTogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2Uge1xyXG4gIGNvbnN0IHJlY3QxID0gZHJhZ2dhYmxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gIGNvbnN0IHJlY3QyID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICBjb25zdCBjZW50ZXIgPSB7XHJcbiAgICB4OiByZWN0MS5sZWZ0ICsgcmVjdDEud2lkdGggLyAyLFxyXG4gICAgeTogcmVjdDEudG9wICsgcmVjdDEuaGVpZ2h0IC8gMixcclxuICB9O1xyXG5cclxuICBjb25zdCBkaXN0YW5jZUZyb21Cb3JkZXI6IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlID0ge1xyXG4gICAgdG9wOiBjZW50ZXIueSAtIHJlY3QyLnRvcCxcclxuICAgIHJpZ2h0OiByZWN0Mi5yaWdodCAtIGNlbnRlci54LFxyXG4gICAgYm90dG9tOiByZWN0Mi5ib3R0b20gLSBjZW50ZXIueSxcclxuICAgIGxlZnQ6IGNlbnRlci54IC0gcmVjdDIubGVmdCxcclxuICB9O1xyXG5cclxuICByZXR1cm4gZGlzdGFuY2VGcm9tQm9yZGVyO1xyXG59XHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBldnQgPT4ge1xyXG4gIGZvciAoIGNvbnN0IHBhaXIgb2YgZGljdEtleXNCeUFjdGlvbiApIHtcclxuICAgIGlmICggZXZ0LmNvZGUgPT09IHBhaXJbMF0gKSB7XHJcbiAgICAgIHBhaXJbMV0uZm9yRWFjaCgga2JFdmVudCA9PiBrYkV2ZW50KCBldnQgKSApO1xyXG4gICAgfVxyXG4gIH1cclxufSApO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRyYW5zZm9ybUNvb3Jkc0Zyb21FbGVtZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCApOiBQb2ludDJEIHtcclxuICBjb25zdCBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZSA9ICggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGVsZW1lbnQgKS50cmFuc2Zvcm0ubWF0Y2goIHJlZ2V4TnVtYmVyUGF0dGVybiApID8/IFswLCAwXSApLm1hcCggbiA9PiArbiApO1xyXG4gIHJldHVybiB7XHJcbiAgICB4OiBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZVs0XSAhPT0gdW5kZWZpbmVkID8gTWF0aC5yb3VuZCggYXJyQ29tcHV0ZWREcmFnZ2FibGVUcmFuc2xhdGVbNF0gKSA6IDAsXHJcbiAgICB5OiBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZVs1XSAhPT0gdW5kZWZpbmVkID8gTWF0aC5yb3VuZCggYXJyQ29tcHV0ZWREcmFnZ2FibGVUcmFuc2xhdGVbNV0gKSA6IDBcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGlja0V2ZW50VG9Db29yZGluYXRlcyggZXZlbnQ6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50ICkge1xyXG4gIGlmICggZXZlbnQgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ICkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogZXZlbnQuY2xpZW50WCxcclxuICAgICAgeTogZXZlbnQuY2xpZW50WVxyXG4gICAgfTtcclxuICB9IGVsc2UgaWYgKCBldmVudCBpbnN0YW5jZW9mIFRvdWNoRXZlbnQgKSB7XHJcbiAgICBjb25zdCB0b3VjaCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogdG91Y2guY2xpZW50WCxcclxuICAgICAgeTogdG91Y2guY2xpZW50WVxyXG4gICAgfTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgXCJFdmVudCBub3QgRm91bmRcIjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoaWRlRWxlbWVudCggZWxlbWVudDogSFRNTEVsZW1lbnQgKSB7XHJcbiAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICBlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICBlbGVtZW50LnN0eWxlLnpJbmRleCA9ICctMSc7XHJcbiAgZWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gIGVsZW1lbnQuc3R5bGUud2lkdGggPSAnMHB4ICFpbXBvcnRhbnQnO1xyXG4gIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzBweCAhaW1wb3J0YW50JztcclxuICBlbGVtZW50LnNldEF0dHJpYnV0ZSggJ2hpZGRlbicsICcnICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzbGVlcEFzeW5jKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPiggKCByZXNvbHZlICkgPT4gc2V0VGltZW91dCggKCkgPT4gcmVzb2x2ZSgpLCBtcyApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBiaW5kRWxlbWVudHNCeUNoZWNrKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQsIG9uQ2hlY2s6IEZ1bmN0aW9uLCBvblVuY2hlY2s6IEZ1bmN0aW9uICkge1xyXG4gIGlmICggdHJpZ2dlckVsZW1lbnQuY2hlY2tlZCApIHtcclxuICAgIG9uQ2hlY2soIHRhcmdldEVsZW1lbnQgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRyaWdnZXJHcm91cCA9IHRyaWdnZXJFbGVtZW50Lm5hbWVcclxuICAgID8gQXJyYXkuZnJvbSggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggYFtuYW1lPVwiJHsgdHJpZ2dlckVsZW1lbnQubmFtZSB9XCJdYCApIClcclxuICAgIDogW3RyaWdnZXJFbGVtZW50XTtcclxuXHJcbiAgdHJpZ2dlckdyb3VwLmZvckVhY2goIHQgPT4gdC5hZGRFdmVudExpc3RlbmVyKCAnY2hhbmdlJywgZXZ0ID0+IHtcclxuICAgIGlmICggdHJpZ2dlckVsZW1lbnQuY2hlY2tlZCApIHtcclxuICAgICAgb25DaGVjayggdGFyZ2V0RWxlbWVudCwgZXZ0ICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBvblVuY2hlY2soIHRhcmdldEVsZW1lbnQsIGV2dCApO1xyXG4gICAgfVxyXG4gIH0gKSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNNb2JpbGVCcm93c2VyKCkge1xyXG4gIHJldHVybiAvQW5kcm9pZHxpUGhvbmUvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc09uU2NyZWVuKCBlbGVtZW50OiBIVE1MRWxlbWVudCApIHtcclxuICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICByZXR1cm4gKFxyXG4gICAgcmVjdC50b3AgPj0gMCAmJlxyXG4gICAgcmVjdC5sZWZ0ID49IDAgJiZcclxuICAgIHJlY3QuYm90dG9tIDw9ICggd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKSAmJlxyXG4gICAgcmVjdC5yaWdodCA8PSAoIHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCApXHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRFbGVtZW50Vmlld0lmQ2hlY2tlZCggdHJpZ2dlckVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIHRhcmdldEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIG9wdGlvbnMgPSB7XHJcbiAgb25DaGVjazogKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQgKSA9PiB7IH0sXHJcbiAgb25VbmNoZWNrOiAoIHRyaWdnZXJFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LCB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudCApID0+IHsgfVxyXG59ICkge1xyXG4gIGJpbmRFbGVtZW50c0J5Q2hlY2soXHJcbiAgICB0cmlnZ2VyRWxlbWVudCxcclxuICAgIHRhcmdldEVsZW1lbnQsXHJcbiAgICAoIGVsOiBIVE1MRWxlbWVudCApID0+IHtcclxuICAgICAgZWwuY2xhc3NMaXN0LmFkZCggJ3Nob3cnICk7XHJcbiAgICAgIG9wdGlvbnMub25DaGVjayggdHJpZ2dlckVsZW1lbnQsIHRhcmdldEVsZW1lbnQgKTtcclxuICAgIH0sXHJcbiAgICAoIGVsOiBIVE1MRWxlbWVudCApID0+IHtcclxuICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSggJ3Nob3cnICk7XHJcbiAgICAgIG9wdGlvbnMub25VbmNoZWNrKCB0cmlnZ2VyRWxlbWVudCwgdGFyZ2V0RWxlbWVudCApO1xyXG4gICAgfSxcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFsdWVGcm9tUmFkaW9Hcm91cCggZ3JvdXBOYW1lOiBzdHJpbmcgKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIGBbbmFtZT0keyBncm91cE5hbWUgfV06Y2hlY2tlZGAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIGlmICggZWwgKSB7XHJcbiAgICByZXR1cm4gZWwudmFsdWU7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuLy8gUmV0b3JuYSB1bWEgZnVuw6fDo28gcXVlIG7Do28gdmFpIHNlciBjb21wbGV0YWRhIGNhc28gc2VqYSBjaGFtYWRhIG5vdmFtZW50ZSBlbSB7IGRlbGF5IH0gbWlsaXNzZWd1bmRvc1xyXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2VGYWN0b3J5KCBmdW5jOiBGdW5jdGlvbiwgZGVsYXk6IG51bWJlciApOiBGdW5jdGlvbiB7XHJcbiAgbGV0IGluRGVib3VuY2U6IG51bWJlcjtcclxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgY29udGV4dCA9IHdpbmRvdztcclxuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICBjbGVhclRpbWVvdXQoIGluRGVib3VuY2UgKTtcclxuICAgIGluRGVib3VuY2UgPSB3aW5kb3cuc2V0VGltZW91dCggKCkgPT4gZnVuYy5hcHBseSggY29udGV4dCwgYXJncyApLCBkZWxheSApO1xyXG4gIH07XHJcbn1cclxuXHJcbi8vIFJldG9ybmEgdW1hIGZ1bsOnw6NvIHF1ZSBzw7MgcG9kZSBzZXIgY29tcGxldGFkYSB1bWEgdmV6IGEgY2FkYSB7IGxpbWl0IH0gbWlsaXNzZWd1bmRvcyBcclxuZXhwb3J0IGZ1bmN0aW9uIHRocm90dGxlRmFjdG9yeSggZnVuYzogRnVuY3Rpb24sIGxpbWl0OiBudW1iZXIgKTogRnVuY3Rpb24ge1xyXG4gIGxldCBsYXN0RnVuYzogbnVtYmVyO1xyXG4gIGxldCBsYXN0UmFuOiBudW1iZXI7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnN0IGNvbnRleHQgPSB3aW5kb3c7XHJcbiAgICBjb25zdCBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgaWYgKCAhbGFzdFJhbiApIHtcclxuICAgICAgZnVuYy5hcHBseSggY29udGV4dCwgYXJncyApO1xyXG4gICAgICBsYXN0UmFuID0gRGF0ZS5ub3coKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCggbGFzdEZ1bmMgKTtcclxuICAgICAgbGFzdEZ1bmMgPSB3aW5kb3cuc2V0VGltZW91dCggZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICggRGF0ZS5ub3coKSAtIGxhc3RSYW4gPj0gbGltaXQgKSB7XHJcbiAgICAgICAgICBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICk7XHJcbiAgICAgICAgICBsYXN0UmFuID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIGxpbWl0IC0gKCBEYXRlLm5vdygpIC0gbGFzdFJhbiApICk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc21vb3RoU2Nyb2xsVG8oIHBvczogbnVtYmVyICk6IHZvaWQge1xyXG4gIHdpbmRvdy5zY3JvbGxUbygge1xyXG4gICAgdG9wOiBwb3MsXHJcbiAgICBiZWhhdmlvcjogJ3Ntb290aCcsXHJcbiAgfSApO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdE9wdGlvbkJ5VGV4dCggaWRTZWxlY3RFbGVtZW50OiBzdHJpbmcsIHNlYXJjaFRleHQ6IHN0cmluZywgY29udGFpbnM6IGJvb2xlYW4gPSBmYWxzZSApOiB2b2lkIHtcclxuICBjb25zdCBzZWxlY3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGlkU2VsZWN0RWxlbWVudCApIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xyXG5cclxuICBpZiAoICFzZWxlY3RFbGVtZW50ICkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgb3B0aW9uc0VsZW1lbnRvU2VsZWN0ID0gWy4uLnNlbGVjdEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCggJ29wdGlvbicgKV07XHJcblxyXG4gIGxldCBzZWxlY3RlZE9wdGlvbjtcclxuICBpZiAoIGNvbnRhaW5zICkge1xyXG4gICAgc2VsZWN0ZWRPcHRpb24gPSBvcHRpb25zRWxlbWVudG9TZWxlY3RcclxuICAgICAgLmZpbHRlciggZWwgPT4gZWwudGV4dENvbnRlbnQgJiYgZWwudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyggc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpICkgKVswXS52YWx1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgc2VsZWN0ZWRPcHRpb24gPSBvcHRpb25zRWxlbWVudG9TZWxlY3RcclxuICAgICAgLmZpbHRlciggZWwgPT4gZWwudGV4dENvbnRlbnQgJiYgZWwudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKSA9PT0gc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpIClbMF0udmFsdWU7XHJcbiAgfVxyXG5cclxuICBzZWxlY3RFbGVtZW50LnZhbHVlID0gc2VsZWN0ZWRPcHRpb247XHJcbn1cclxuXHJcbiIsImltcG9ydCAnLi9ET01FeHRlbnNpb25zJztcclxuaW1wb3J0ICcuL1N0cmluZ0V4dGVuc2lvbnMnO1xyXG5cclxuZXhwb3J0IHR5cGUgTGF5ZXJDb25maWcgPSB7XHJcbiAgcHJpb3JpdHk6IG51bWJlcjtcclxuICBiYWNrZ3JvdW5kU3R5bGU/OiBzdHJpbmc7XHJcbiAgYmFja2dyb3VuZEltYWdlPzogc3RyaW5nLFxyXG4gIGNsYXNzTGlzdD86IHN0cmluZ1tdLFxyXG4gIGZpbHRlcj86IHN0cmluZztcclxuICBjdXJzb3I/OiBzdHJpbmc7XHJcbiAgb25DbGljaz86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZDtcclxuICBvbk1vdXNlT3Zlcj86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZDtcclxuICBvbk1vdXNlRG93bj86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZDtcclxuICBvbk1vdXNlVXA/OiAoIGxheWVyOiBMYXllciApID0+IHZvaWQ7XHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgTGF5ZXIge1xyXG4gIHB1YmxpYyBlbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICBwdWJsaWMgcHJpb3JpdHk6IG51bWJlcjtcclxuICBwdWJsaWMgYmFja2dyb3VuZFN0eWxlPzogc3RyaW5nO1xyXG4gIHB1YmxpYyBiYWNrZ3JvdW5kSW1hZ2U/OiBzdHJpbmc7XHJcbiAgcHVibGljIGZpbHRlcj86IHN0cmluZztcclxuICBwdWJsaWMgY2xhc3NMaXN0Pzogc3RyaW5nW107XHJcblxyXG4gIHB1YmxpYyBjdXJzb3I/OiBzdHJpbmc7XHJcbiAgb25DbGljaz86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZDtcclxuICBvbk1vdXNlT3Zlcj86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZDtcclxuICBvbk1vdXNlRG93bj86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZDtcclxuICBvbk1vdXNlVXA/OiAoIGxheWVyOiBMYXllciApID0+IHZvaWQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCB7IHByaW9yaXR5LCBiYWNrZ3JvdW5kU3R5bGUsIGJhY2tncm91bmRJbWFnZSwgZmlsdGVyLCBjdXJzb3IsIG9uQ2xpY2ssIG9uTW91c2VPdmVyLCBvbk1vdXNlRG93biwgb25Nb3VzZVVwLCBjbGFzc0xpc3QgfTogTGF5ZXJDb25maWcgKSB7XHJcbiAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XHJcbiAgICB0aGlzLmZpbHRlciA9IGZpbHRlcjtcclxuICAgIHRoaXMuYmFja2dyb3VuZFN0eWxlID0gYmFja2dyb3VuZFN0eWxlO1xyXG4gICAgdGhpcy5iYWNrZ3JvdW5kSW1hZ2UgPSBiYWNrZ3JvdW5kSW1hZ2U7XHJcbiAgICB0aGlzLmN1cnNvciA9IGN1cnNvcjtcclxuICAgIHRoaXMuY2xhc3NMaXN0ID0gY2xhc3NMaXN0O1xyXG4gICAgdGhpcy5vbkNsaWNrID0gb25DbGljaztcclxuICAgIHRoaXMub25Nb3VzZU92ZXIgPSBvbk1vdXNlT3ZlcjtcclxuICAgIHRoaXMub25Nb3VzZURvd24gPSBvbk1vdXNlRG93bjtcclxuICAgIHRoaXMub25Nb3VzZVVwID0gb25Nb3VzZVVwO1xyXG4gICAgdGhpcy5lbGVtZW50ID0gTGF5ZXIuZ2V0TGF5ZXJFbGVtZW50KFxyXG4gICAgICB0aGlzLFxyXG4gICAgICB0aGlzLnByaW9yaXR5LFxyXG4gICAgICB0aGlzLmNsYXNzTGlzdCxcclxuICAgICAgdGhpcy5iYWNrZ3JvdW5kU3R5bGUsXHJcbiAgICAgIHRoaXMuYmFja2dyb3VuZEltYWdlLFxyXG4gICAgICB0aGlzLmZpbHRlcixcclxuICAgICAgdGhpcy5jdXJzb3IsXHJcbiAgICAgIHRoaXMub25DbGljayxcclxuICAgICAgdGhpcy5vbk1vdXNlT3ZlcixcclxuICAgICAgdGhpcy5vbk1vdXNlRG93bixcclxuICAgICAgdGhpcy5vbk1vdXNlVXBcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0UGFyZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCApIHtcclxuICAgIGVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50ICk7XHJcblxyXG4gICAgaWYgKCB0aGlzLmVsZW1lbnQucGFyZW50RWxlbWVudCAmJiB0aGlzLmVsZW1lbnQucGFyZW50RWxlbWVudC5pZCApIHtcclxuICAgICAgY29uc3QgcGFyZW50SWQgPSB0aGlzLmVsZW1lbnQucGFyZW50RWxlbWVudC5pZDtcclxuICAgICAgY29uc3QgbnVtTGF5ZXJzID0gdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggJ2xheWVyJyApLmxlbmd0aCAtIDE7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5pZCA9IGBsYXllciR7IG51bUxheWVycyB9JHsgcGFyZW50SWQuY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCkgfWA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0QXNNYWluTGF5ZXIoIGVsZW1lbnQ6IEhUTUxFbGVtZW50ICkge1xyXG4gICAgZWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoICdiZWZvcmVlbmQnLCB0aGlzLmVsZW1lbnQgKTtcclxuXHJcbiAgICBpZiAoIHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50ICYmIHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50LmlkICkge1xyXG4gICAgICBjb25zdCBwYXJlbnRJZCA9IHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50LmlkO1xyXG4gICAgICB0aGlzLmVsZW1lbnQuaWQgPSBgbWFpbkxheWVyJHsgcGFyZW50SWQuY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCkgfWA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBnZXRMYXllckVsZW1lbnQoIGxheWVyOiBMYXllciwgcHJpb3JpdHk6IG51bWJlciwgY2xhc3NMaXN0Pzogc3RyaW5nW10sIGJhY2tncm91bmRTdHlsZT86IHN0cmluZywgYmFja2dyb3VuZEltYWdlPzogc3RyaW5nLCBmaWx0ZXI/OiBzdHJpbmcsIGN1cnNvcj86IHN0cmluZywgb25DbGljaz86ICggbGF5ZXI6IExheWVyICkgPT4gdm9pZCwgb25Nb3VzZU92ZXI/OiAoIGxheWVyOiBMYXllciApID0+IHZvaWQsIG9uTW91c2VEb3duPzogKCBsYXllcjogTGF5ZXIgKSA9PiB2b2lkLCBvbk1vdXNlVXA/OiAoIGxheWVyOiBMYXllciApID0+IHZvaWQgKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3QgbGF5ZXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG5cclxuICAgIGxheWVyRGl2LmNsYXNzTGlzdC5hZGQoIC4uLiggY2xhc3NMaXN0IHx8IFtdICkgKTtcclxuICAgIGxheWVyRGl2LmNsYXNzTGlzdC5hZGQoICdsYXllcicgKTtcclxuICAgIGxheWVyRGl2Lm1ha2VDb3ZlcigpO1xyXG4gICAgbGF5ZXJEaXYuc3R5bGUuekluZGV4ID0gcHJpb3JpdHkgPiAwID8gcHJpb3JpdHkudG9TdHJpbmcoKSA6ICcwJztcclxuXHJcbiAgICBpZiAoIGJhY2tncm91bmRTdHlsZSApIHtcclxuICAgICAgbGF5ZXJEaXYuc3R5bGUuYmFja2dyb3VuZCA9IGJhY2tncm91bmRTdHlsZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIGZpbHRlciApIHtcclxuICAgICAgbGF5ZXJEaXYuc3R5bGUuZmlsdGVyID0gZmlsdGVyO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggY3Vyc29yICkge1xyXG4gICAgICBsYXllckRpdi5zdHlsZS5jdXJzb3IgPSBjdXJzb3I7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBvbkNsaWNrICkge1xyXG4gICAgICBsYXllckRpdi5hZGRFdmVudExpc3RlbmVyKCAnY2xpY2snLCAoKSA9PiB7IG9uQ2xpY2soIGxheWVyICkgfSApXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBvbk1vdXNlT3ZlciApIHtcclxuICAgICAgbGF5ZXJEaXYuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlb3ZlcicsICgpID0+IHsgb25Nb3VzZU92ZXIoIGxheWVyICkgfSApXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBvbk1vdXNlRG93biApIHtcclxuICAgICAgbGF5ZXJEaXYuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsICgpID0+IHsgb25Nb3VzZURvd24oIGxheWVyICkgfSApXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBvbk1vdXNlVXAgKSB7XHJcbiAgICAgIGxheWVyRGl2LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgKCkgPT4geyBvbk1vdXNlVXAoIGxheWVyICkgfSApXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBiYWNrZ3JvdW5kSW1hZ2UgKSB7XHJcbiAgICAgIHRoaXMuc2V0TGF5ZXJCYWNrZ3JvdW5kSW1hZ2UoIGxheWVyRGl2LCBiYWNrZ3JvdW5kSW1hZ2UgKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBsYXllckRpdjtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIHNldExheWVyQmFja2dyb3VuZEltYWdlKCBsYXllckRpdjogSFRNTERpdkVsZW1lbnQsIGJhY2tncm91bmRJbWFnZTogc3RyaW5nICkge1xyXG4gICAgY29uc3QgaW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2ltZycgKTtcclxuICAgIGltYWdlRWxlbWVudC5zcmMgPSBiYWNrZ3JvdW5kSW1hZ2U7XHJcbiAgICBpbWFnZUVsZW1lbnQuc3R5bGUudXNlclNlbGVjdCA9ICdub25lJztcclxuICAgIGltYWdlRWxlbWVudC5zdHlsZS5tYXhXaWR0aCA9ICcxMDAlJztcclxuICAgIGltYWdlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XHJcbiAgICBpbWFnZUVsZW1lbnQubWFrZUNvdmVyKCk7XHJcblxyXG4gICAgbGF5ZXJEaXYuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCAnYWZ0ZXJiZWdpbicsIGltYWdlRWxlbWVudCApO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbiIsImV4cG9ydCBjb25zdCByZWdleE51bWJlclBhdHRlcm4gPSAvLT9cXGQrXFwuP1xcZCovZztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUG9pbnQyRCB7XHJcbiAgeDogbnVtYmVyO1xyXG4gIHk6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEaW1lbnNpb25zIHtcclxuICB3aWR0aDogbnVtYmVyO1xyXG4gIGhlaWdodDogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5kZXhUb1JvdyggaW5kZXg6IG51bWJlciwgZ3JpZFdpZHRoOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIE1hdGguZmxvb3IoIGluZGV4IC8gZ3JpZFdpZHRoICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbmRleFRvQ29sKCBpbmRleDogbnVtYmVyLCBncmlkV2lkdGg6IG51bWJlciApIHtcclxuICByZXR1cm4gaW5kZXggJSBncmlkV2lkdGg7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByb3dDb2xUb0luZGV4KCByb3c6IG51bWJlciwgY29sOiBudW1iZXIsIHdpZHRoOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuICggcm93ICogd2lkdGggKSArIGNvbDtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBsZXJwKCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIsIGFtb3VudDogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgcmV0dXJuICggMSAtIGFtb3VudCApICogbWluICsgYW1vdW50ICogbWF4O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW52ZXJzZUxlcnAoIGE6IG51bWJlciwgYjogbnVtYmVyLCB2YWw6IG51bWJlciApOiBudW1iZXIge1xyXG4gIHJldHVybiAoIHZhbCAtIGEgKSAvICggYiAtIGEgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbWFwKCBpbk1pbjogbnVtYmVyLCBpbk1heDogbnVtYmVyLCBvdXRNaW46IG51bWJlciwgb3V0TWF4OiBudW1iZXIsIHZhbDogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgcmV0dXJuIGxlcnAoIG91dE1pbiwgb3V0TWF4LCBpbnZlcnNlTGVycCggaW5NaW4sIGluTWF4LCB2YWwgKSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmFuZG9tSW50RXhjbHVzaXZlKCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIE1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkgKiAoIG1heCAtIG1pbiApICsgbWluICk7XHJcbn1cclxuXHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJhbmRvbUludEluY2x1c2l2ZSggbWluOiBudW1iZXIsIG1heDogbnVtYmVyICkge1xyXG4gIG1pbiA9IE1hdGguY2VpbCggbWluICk7XHJcbiAgbWF4ID0gTWF0aC5mbG9vciggbWF4ICk7XHJcbiAgcmV0dXJuIE1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkgKiAoIG1heCAtIG1pbiArIDEgKSApICsgbWluO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmFuZG9tRnJvbUFycmF5PFQ+KCBhcnI6IEFycmF5PFQ+ICkge1xyXG4gIHJldHVybiBhcnJbZ2V0UmFuZG9tSW50RXhjbHVzaXZlKCAwLCBhcnIubGVuZ3RoICldO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xhbXAoIG51bTogbnVtYmVyID0gMCwgbWluOiBudW1iZXIgPSAwLCBtYXg6IG51bWJlciA9IDEwMCApOiBudW1iZXIge1xyXG4gIHJldHVybiBNYXRoLm1heCggbWluLCBNYXRoLm1pbiggbnVtLCBtYXggKSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWludXRlc1RvTWlsbGlzZWNvbmRzKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBtcyAqIDYwMDAwO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWlsbGlzZWNvbmRzVG9NaW51dGVzKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBtcyAvIDYwMDAwO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWlsbGlzZWNvbmRzVG9Ib3VycyggbXM6IG51bWJlciApIHtcclxuICByZXR1cm4gbXMgLyAzLjZlKzY7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtaWxsaXNlY29uZHNUb0RheXMoIG1zOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIG1zIC8gOC42NGUrNztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1lZ2FieXRlVG9CeXRlKCBtYjogbnVtYmVyICkge1xyXG4gIHJldHVybiBtYiAqIDEwMjQgKiAxMDI0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnl0ZVRvTWVnYWJ5dGUoIGI6IG51bWJlciApIHtcclxuICByZXR1cm4gYiAvIDEwMjQgLyAxMDI0O1xyXG59IiwiaW1wb3J0IHsgTGF5ZXIsIExheWVyQ29uZmlnIH0gZnJvbSAnLi9MYXllcic7XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vQ29tcG9uZW50JztcclxuXHJcbmV4cG9ydCB0eXBlIFNjZW5lQ29uZmlnID0ge1xyXG4gIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgbGF5ZXJzOiBMYXllcltdO1xyXG4gIGNvbXBvbmVudHM/OiBDb21wb25lbnRbXTtcclxuICBtYWluTGF5ZXJDb25maWc/OiBMYXllckNvbmZpZztcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBTY2VuZSB7XHJcbiAgcHVibGljIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgcHVibGljIGVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gIHB1YmxpYyBsYXllcnM6IExheWVyW107XHJcbiAgcHVibGljIGNvbXBvbmVudHM6IENvbXBvbmVudFtdO1xyXG4gIHB1YmxpYyBtYWluTGF5ZXI/OiBMYXllcjtcclxuICBwdWJsaWMgbWFpbkxheWVyQ29uZmlnPzogTGF5ZXJDb25maWc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCB7IGNvbnRhaW5lciwgbGF5ZXJzLCBjb21wb25lbnRzLCBtYWluTGF5ZXJDb25maWcgfTogU2NlbmVDb25maWcgKSB7XHJcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuXHJcbiAgICB0aGlzLm1haW5MYXllckNvbmZpZyA9IG1haW5MYXllckNvbmZpZztcclxuICAgIHRoaXMubGF5ZXJzID0gbGF5ZXJzO1xyXG4gICAgdGhpcy5jb21wb25lbnRzID0gY29tcG9uZW50cyB8fCBbXTtcclxuXHJcbiAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG5cclxuICAgIHRoaXMuY29tcG9uZW50cy5mb3JFYWNoKCBjID0+IHRoaXMuZWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoICdiZWZvcmVlbmQnLCBjLmNvbnRhaW5lciApIClcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhc3luYyBidWlsZCgpIHtcclxuICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoICdzY2VuZS1jb250YWluZXInICk7XHJcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCggJ3NjZW5lJyApO1xyXG4gICAgdGhpcy5zZXR1cExheWVycygpO1xyXG4gICAgdGhpcy5zZXRFbGVtZW50U3R5bGUoKTtcclxuICAgIHRoaXMuY29udGFpbmVyLmluc2VydEFkamFjZW50RWxlbWVudCggJ2JlZm9yZWVuZCcsIHRoaXMuZWxlbWVudCApO1xyXG4gICAgdGhpcy5jb21wb25lbnRzLmZvckVhY2goIGFzeW5jIGMgPT4gYXdhaXQgYy5idWlsZCggdGhpcyApICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0TWFpbkxheWVyKCkge1xyXG5cclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgc2NlbmVDb3VudGVyKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCggYCMkeyB0aGlzLmNvbnRhaW5lci5pZCB9ID4gLnNjZW5lYCApLmxlbmd0aDtcclxuICB9XHJcblxyXG4gIHNldHVwTGF5ZXJzKCkge1xyXG4gICAgaWYgKCAhdGhpcy5jb250YWluZXIuaWQgKSB7XHJcbiAgICAgIHRoaXMuY29udGFpbmVyLmlkID0gYHNjZW5lQ29udGFpbmVyJHsgdGhpcy5jb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggJ3NjZW5lLWNvbnRhaW5lcicgKS5sZW5ndGggfWA7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5pZCA9IGBzY2VuZSR7IHRoaXMuc2NlbmVDb3VudGVyIH1gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5lbGVtZW50LmlkID0gYCR7IHRoaXMuY29udGFpbmVyLmlkIH0keyB0aGlzLnNjZW5lQ291bnRlciB9YDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmxheWVycy5mb3JFYWNoKCBsID0+IHtcclxuICAgICAgbC5zZXRQYXJlbnQoIHRoaXMuZWxlbWVudCApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGlmICggdGhpcy5tYWluTGF5ZXJDb25maWcgKSB7XHJcbiAgICAgIHRoaXMubWFpbkxheWVyID0gbmV3IExheWVyKCB7IC4uLnRoaXMubWFpbkxheWVyQ29uZmlnLCBwcmlvcml0eTogOTk5IH0gKTtcclxuICAgICAgdGhpcy5tYWluTGF5ZXIuc2V0QXNNYWluTGF5ZXIoIHRoaXMuZWxlbWVudCApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tYWluTGF5ZXIgPSBuZXcgTGF5ZXIoIHsgcHJpb3JpdHk6IDk5OSB9ICk7XHJcbiAgICAgIHRoaXMubWFpbkxheWVyLnNldEFzTWFpbkxheWVyKCB0aGlzLmVsZW1lbnQgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEVsZW1lbnRTdHlsZSgpIHtcclxuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcclxuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmZsZXhXcmFwID0gJ3dyYXAnO1xyXG5cclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDB2dyc7XHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzEwMHZoJztcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gJzAnO1xyXG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9ICcwJztcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG4gIH1cclxufSIsIlxyXG5pbnRlcmZhY2UgU3RyaW5nIHtcclxuICB0cnVuY2F0ZSggbWF4OiBudW1iZXIsIGRlY29yYXRvcjogc3RyaW5nICk6IHN0cmluZztcclxuICByZW1vdmVBY2NlbnRzKCk6IHN0cmluZztcclxuICBjYXBpdGFsaXplRmlyc3RMZXR0ZXIoKTogc3RyaW5nO1xyXG4gIHplcm9CZWZvcmUoKTogc3RyaW5nO1xyXG4gIGlzTnVsbE9yRW1wdHkoKTogYm9vbGVhbjtcclxufVxyXG5cclxuU3RyaW5nLnByb3RvdHlwZS5pc051bGxPckVtcHR5ID0gZnVuY3Rpb24gKCk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiB0eXBlb2YgdGhpcyAhPT0gJ3N0cmluZycgJiYgIXRoaXMgJiYgdGhpcyAhPT0gJyc7XHJcbn07XHJcblxyXG5TdHJpbmcucHJvdG90eXBlLnRydW5jYXRlID0gZnVuY3Rpb24gKCBtYXg6IG51bWJlciwgZGVjb3JhdG9yOiBzdHJpbmcgPSAnLi4uJyApOiBzdHJpbmcge1xyXG4gIHJldHVybiAoIHRoaXMubGVuZ3RoID4gbWF4ID8gdGhpcy5zdWJzdHJpbmcoIDAsIG1heCApICsgZGVjb3JhdG9yIDogdGhpcyApLnRvU3RyaW5nKCk7XHJcbn07XHJcblxyXG5TdHJpbmcucHJvdG90eXBlLnJlbW92ZUFjY2VudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgcmV0dXJuIHRoaXMubm9ybWFsaXplKCAnTkZEJyApLnJlcGxhY2UoIC9bXFx1MDMwMC1cXHUwMzZmXS9nLCBcIlwiICk7XHJcbn1cclxuXHJcblN0cmluZy5wcm90b3R5cGUuY2FwaXRhbGl6ZUZpcnN0TGV0dGVyID0gZnVuY3Rpb24gKCk6IHN0cmluZyB7XHJcbiAgaWYgKCB0eXBlb2YgdGhpcyAhPT0gJ3N0cmluZycgKSB7XHJcbiAgICByZXR1cm4gJyc7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdGhpcy5jaGFyQXQoIDAgKS50b1VwcGVyQ2FzZSgpICsgdGhpcy5zdWJzdHJpbmcoIDEgKTtcclxufVxyXG5cclxuU3RyaW5nLnByb3RvdHlwZS56ZXJvQmVmb3JlID0gZnVuY3Rpb24gKCkge1xyXG4gIHJldHVybiB0aGlzLnBhZFN0YXJ0KCAyLCAnMCcgKTtcclxufSIsImltcG9ydCB7IElQb2ludDJEIH0gZnJvbSAnLi9pbnRlcmZhY2VzJztcclxuXHJcbmV4cG9ydCBlbnVtIENPTlZFUlNJT05fVU5JVCB7IFBJWEVMLCBQRVJDRU5UQUdFIH1cclxuZXhwb3J0IGVudW0gRElSRUNUSU9OX1JFRkVSRU5DRSB7IEhPUklaT05UQUwsIFZFUlRJQ0FMIH1cclxuZXhwb3J0IGVudW0gVkVSVElDQUxfUkVGRVJFTkNFIHsgRlJPTV9UT1AsIEZST01fQk9UVE9NIH1cclxuXHJcbmV4cG9ydCBlbnVtIENPTE9SX0NIQU5ORUwgeyBSLCBHLCBCLCBBIH07XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbXBhcmFibGU8VD4ge1xyXG4gIGVxdWFscyggYjogVCApOiBib29sZWFuO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIENTU1Bvc2l0aW9uIGltcGxlbWVudHMgSVBvaW50MkQge1xyXG4gIHB1YmxpYyB4OiBudW1iZXI7XHJcbiAgcHVibGljIHk6IG51bWJlcjtcclxuICBwcml2YXRlIHR5cGU6IENPTlZFUlNJT05fVU5JVDtcclxuICBwdWJsaWMgdmVydGljYWxSZWZlcmVuY2U6IFZFUlRJQ0FMX1JFRkVSRU5DRTtcclxuXHJcbiAgY29uc3RydWN0b3IoIHsgeCwgeSwgdmVydGljYWxSZWZlcmVuY2UgPSBWRVJUSUNBTF9SRUZFUkVOQ0UuRlJPTV9UT1AsIHR5cGUgPSBDT05WRVJTSU9OX1VOSVQuUElYRUwgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgdmVydGljYWxSZWZlcmVuY2U/OiBWRVJUSUNBTF9SRUZFUkVOQ0U7IHR5cGU/OiBDT05WRVJTSU9OX1VOSVQ7IH0gKSB7XHJcbiAgICBbdGhpcy54LCB0aGlzLnksIHRoaXMudmVydGljYWxSZWZlcmVuY2UsIHRoaXMudHlwZV0gPSBbeCwgeSwgdmVydGljYWxSZWZlcmVuY2UsIHR5cGVdO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGhvcml6b250YWwoKTogc3RyaW5nIHtcclxuICAgIHN3aXRjaCAoIHRoaXMudHlwZSApIHtcclxuICAgICAgY2FzZSBDT05WRVJTSU9OX1VOSVQuUElYRUw6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnggfXB4YDtcclxuICAgICAgY2FzZSBDT05WRVJTSU9OX1VOSVQuUEVSQ0VOVEFHRTpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueCB9JWA7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnggfXB4YDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldCB2ZXJ0aWNhbCgpOiBzdHJpbmcge1xyXG4gICAgc3dpdGNoICggdGhpcy50eXBlICkge1xyXG4gICAgICBjYXNlIENPTlZFUlNJT05fVU5JVC5QSVhFTDpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueSB9cHhgO1xyXG4gICAgICBjYXNlIENPTlZFUlNJT05fVU5JVC5QRVJDRU5UQUdFOlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy55IH0lYDtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueSB9cHhgO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHR5cGUgQ29sbGlzaW9uRGlyZWN0aW9uQ2hlY2sgPSB7XHJcbiAgdG9wOiBib29sZWFuO1xyXG4gIHJpZ2h0OiBib29sZWFuO1xyXG4gIGNlbnRlcjogYm9vbGVhbjtcclxuICBib3R0b206IGJvb2xlYW47XHJcbiAgbGVmdDogYm9vbGVhbjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIENvbGxpc2lvbkJvcmRlckRpc3RhbmNlID0ge1xyXG4gIHRvcDogbnVtYmVyO1xyXG4gIHJpZ2h0OiBudW1iZXI7XHJcbiAgYm90dG9tOiBudW1iZXI7XHJcbiAgbGVmdDogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElDb2xsaXNpb25FdmVudCB7XHJcbiAgdGFyZ2V0Q2xhc3M6IHN0cmluZztcclxuICBhdXRvSW5zZXJ0VGFyZ2V0Q2xhc3M6IGJvb2xlYW47XHJcbiAgb25Db2xsaWRpbmcoIGRyYWdnYWJsZTogSFRNTEVsZW1lbnQsIHRhcmdldDogSFRNTEVsZW1lbnQsIGNvbGxpZGluZ0F0OiBDb2xsaXNpb25EaXJlY3Rpb25DaGVjaywgZGlzdGFuY2VGcm9tQm9yZGVyOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSApOiBQcm9taXNlPHZvaWQ+O1xyXG4gIG9uTm90Q29sbGlkaW5nKCBkcmFnZ2FibGU6IEhUTUxFbGVtZW50LCB0YXJnZXQ6IEhUTUxFbGVtZW50ICk6IFByb21pc2U8dm9pZD47XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIENvbGxpc2lvblRyaWdnZXJPcHRpb25zID0ge1xyXG4gIHRyaWdnZXJFbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICBldmVudHM6IElDb2xsaXNpb25FdmVudFtdO1xyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIENvbGxpc2lvbkJvcmRlckRpc3RhbmNlRXh0cmFzIHtcclxuICBjb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXM6IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlO1xyXG5cclxuICBjb25zdHJ1Y3RvciggY29sbGlzaW9uQm9yZGVyRGlzdGFuY2U6IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlICkge1xyXG4gICAgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMgPSBjb2xsaXNpb25Cb3JkZXJEaXN0YW5jZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhbnlHcmVhdGVyVGhhbiggbnVtOiBudW1iZXIgKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMudG9wID4gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLnJpZ2h0ID4gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmJvdHRvbSA+IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5sZWZ0ID4gbnVtO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFueUxvd2VyVGhhbiggbnVtOiBudW1iZXIgKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMudG9wIDwgbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLnJpZ2h0IDwgbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmJvdHRvbSA8IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5sZWZ0IDwgbnVtO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFueUVxdWFscyggbnVtOiBudW1iZXIgKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMudG9wID09PSBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMucmlnaHQgPT09IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5ib3R0b20gPT09IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5sZWZ0ID09PSBudW07XHJcbiAgfVxyXG59IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vQ29tcG9uZW50JztcclxuaW1wb3J0IHsgaXNNb2JpbGVCcm93c2VyLCBkZWJvdW5jZUZhY3RvcnksIHRocm90dGxlRmFjdG9yeSB9IGZyb20gJy4vRE9NVG9vbHMnO1xyXG5pbXBvcnQgeyBjbGFtcCB9IGZyb20gJy4vTWF0aFRvb2xzJztcclxuaW1wb3J0IHsgU2NlbmUsIFNjZW5lQ29uZmlnIH0gZnJvbSAnLi9TY2VuZSc7XHJcbmltcG9ydCB7IERJUkVDVElPTl9SRUZFUkVOQ0UgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmV4cG9ydCB0eXBlIENvbmNhdGVuYXRlU2NlbmVDb25maWcgPSB7XHJcbiAgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuICBkaXJlY3Rpb246IERJUkVDVElPTl9SRUZFUkVOQ0U7XHJcbiAgY29tcG9uZW50cz86IENvbXBvbmVudFtdO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29uY2F0ZW5hdGVTY2VuZSBleHRlbmRzIFNjZW5lIHtcclxuICBwdWJsaWMgc2NlbmVzOiBTY2VuZVtdID0gW107XHJcbiAgcHVibGljIGluZGV4OiBudW1iZXIgPSAwO1xyXG4gIHByaXZhdGUgY3VycmVudFNjZW5lQ2xhc3NOYW1lOiBzdHJpbmcgPSAnc2hvdyc7XHJcbiAgcHJpdmF0ZSBkaXJlY3Rpb246IERJUkVDVElPTl9SRUZFUkVOQ0U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCBjb25maWc6IENvbmNhdGVuYXRlU2NlbmVDb25maWcgKSB7XHJcbiAgICBzdXBlcigge1xyXG4gICAgICBjb250YWluZXI6IGNvbmZpZy5jb250YWluZXIsXHJcbiAgICAgIGxheWVyczogW10sXHJcbiAgICAgIGNvbXBvbmVudHM6IGNvbmZpZy5jb21wb25lbnRzIHx8IFtdXHJcbiAgICB9ICk7XHJcbiAgICB0aGlzLmRpcmVjdGlvbiA9IGNvbmZpZy5kaXJlY3Rpb247XHJcbiAgfVxyXG5cclxuICBhc3luYyBidWlsZCgpIHtcclxuICAgIGF3YWl0IHN1cGVyLmJ1aWxkKCk7XHJcbiAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCAnc2NlbmUtY29udGFpbmVyJywgJ2NvbmNhdGVuYXRlLXNjZW5lJyApO1xyXG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmZsZXhXcmFwID0gJ3dyYXAnO1xyXG5cclxuICAgIHRoaXMuc2V0dXBFbGVtZW50KCk7XHJcbiAgICB0aGlzLnNldHVwU2NlbmVzKCk7XHJcblxyXG4gICAgdGhpcy5zY2VuZXMuZm9yRWFjaCggYXN5bmMgc2MgPT4gYXdhaXQgc2MuYnVpbGQoKSApO1xyXG4gIH1cclxuXHJcbiAgcHVzaCggc2NlbmVzOiBTY2VuZSB8IFNjZW5lW10gKSB7XHJcbiAgICBpZiAoICFzY2VuZXMgKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoICFBcnJheS5pc0FycmF5KCBzY2VuZXMgKSApIHtcclxuICAgICAgc2NlbmVzID0gW3NjZW5lc107XHJcbiAgICB9XHJcblxyXG4gICAgc2NlbmVzLmZvckVhY2goICggc2MsIGluZGV4ICkgPT4ge1xyXG4gICAgICB0aGlzLnNjZW5lcy5wdXNoKCBzYyApO1xyXG5cclxuICAgICAgaWYgKCBpbmRleCA9PT0gMCApIHtcclxuICAgICAgICB0aGlzLnNjZW5lc1swXS5lbGVtZW50LmNsYXNzTGlzdC5hZGQoIHRoaXMuY3VycmVudFNjZW5lQ2xhc3NOYW1lICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIHB1c2hTY2VuZUJ5Q29uZmlnKCBzY2VuZXM6IFNjZW5lQ29uZmlnIHwgU2NlbmVDb25maWdbXSApIHtcclxuICAgIGlmICggIXNjZW5lcyApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggIUFycmF5LmlzQXJyYXkoIHNjZW5lcyApICkge1xyXG4gICAgICBzY2VuZXMgPSBbc2NlbmVzXTtcclxuICAgIH1cclxuXHJcbiAgICBzY2VuZXMuZm9yRWFjaCggKCBzYywgaW5kZXggKSA9PiB7XHJcbiAgICAgIHRoaXMuc2NlbmVzLnB1c2goIG5ldyBTY2VuZSgge1xyXG4gICAgICAgIC4uLnNjLFxyXG4gICAgICAgIGNvbnRhaW5lcjogdGhpcy5lbGVtZW50XHJcbiAgICAgIH0gKSApO1xyXG5cclxuICAgICAgaWYgKCBpbmRleCA9PT0gMCApIHtcclxuICAgICAgICB0aGlzLnNjZW5lc1swXS5lbGVtZW50LmNsYXNzTGlzdC5hZGQoIHRoaXMuY3VycmVudFNjZW5lQ2xhc3NOYW1lICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLnNjZW5lcy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaXNGaXJzdFNjZW5lKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5kZXggPT09IDA7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaXNMYXN0U2NlbmUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pbmRleCA9PT0gdGhpcy5sZW5ndGggLSAxO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHByZXYoKSB7XHJcbiAgICB0aGlzLmdvVG8oIHRoaXMuaW5kZXggLSAxICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbmV4dCgpIHtcclxuICAgIHRoaXMuZ29UbyggdGhpcy5pbmRleCArIDEgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnb1RvKCBpbmRleDogbnVtYmVyICkge1xyXG4gICAgdGhpcy5zZXRDdXJyZW50U2NlbmVCeUluZGV4KCBpbmRleCApO1xyXG5cclxuICAgIGlmICggdGhpcy5kaXJlY3Rpb24gPT09IERJUkVDVElPTl9SRUZFUkVOQ0UuSE9SSVpPTlRBTCApIHtcclxuICAgICAgdGhpcy5lbGVtZW50LnNjcm9sbFRvKCB7XHJcbiAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgIGxlZnQ6IHdpbmRvdy5pbm5lcldpZHRoICogaW5kZXgsXHJcbiAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnXHJcbiAgICAgIH0gKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zY3JvbGxUbygge1xyXG4gICAgICAgIHRvcDogd2luZG93LmlubmVySGVpZ2h0ICogaW5kZXgsXHJcbiAgICAgICAgbGVmdDogMCxcclxuICAgICAgICBiZWhhdmlvcjogJ3Ntb290aCdcclxuICAgICAgfSApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXRDdXJyZW50U2NlbmVCeUluZGV4KCBpbmRleDogbnVtYmVyICkge1xyXG4gICAgaW5kZXggPSBjbGFtcCggaW5kZXgsIDAsIHRoaXMuc2NlbmVzLmxlbmd0aCAtIDEgKTtcclxuXHJcbiAgICBBcnJheS5mcm9tKCB0aGlzLmVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggdGhpcy5jdXJyZW50U2NlbmVDbGFzc05hbWUgKSApLmZvckVhY2goIHMgPT4ge1xyXG4gICAgICBzLmNsYXNzTGlzdC5yZW1vdmUoIHRoaXMuY3VycmVudFNjZW5lQ2xhc3NOYW1lICk7XHJcbiAgICB9ICk7XHJcblxyXG4gICAgdGhpcy5zY2VuZXNbaW5kZXhdLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCggdGhpcy5jdXJyZW50U2NlbmVDbGFzc05hbWUgKTtcclxuXHJcbiAgICB0aGlzLmluZGV4ID0gaW5kZXg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0dXBTY2VuZXMoKSB7XHJcbiAgICB0aGlzLnNjZW5lcy5mb3JFYWNoKCBzID0+IHtcclxuICAgICAgcy5lbGVtZW50LnN0eWxlLmZsZXggPSAnbm9uZSc7XHJcbiAgICAgIHMuZWxlbWVudC5zdHlsZS5zY3JvbGxTbmFwQWxpZ24gPSAnY2VudGVyJztcclxuICAgIH0gKVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldHVwRWxlbWVudCgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5zY3JvbGxCZWhhdmlvciA9ICdzbW9vdGgnO1xyXG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcblxyXG4gICAgaWYgKCB0aGlzLmRpcmVjdGlvbiA9PT0gRElSRUNUSU9OX1JFRkVSRU5DRS5IT1JJWk9OVEFMICkge1xyXG4gICAgICB0aGlzLnNldHVwRWxlbWVudEhvcml6b250YWwoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuc2V0dXBFbGVtZW50VmVydGljYWwoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZmxleFdyYXAgPSAnbm93cmFwJztcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5zY3JvbGxTbmFwQWxpZ24gPSAnY2VudGVyJztcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdiYXNlbGluZSc7XHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gIH1cclxuXHJcbiAgc2V0dXBFbGVtZW50SG9yaXpvbnRhbCgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ2NvbHVtbic7XHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuc2Nyb2xsU25hcFR5cGUgPSAneCBtYW5kYXRvcnknO1xyXG5cclxuICAgIGNvbnN0IHJlc2V0U2NlbmVJbmRleEZ1bmN0aW9uID0gZGVib3VuY2VGYWN0b3J5KCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuc2V0Q3VycmVudFNjZW5lQnlJbmRleCggTWF0aC5yb3VuZCggdGhpcy5lbGVtZW50LnNjcm9sbExlZnQgLyB3aW5kb3cuaW5uZXJXaWR0aCApIClcclxuICAgIH0sIDUwMCApO1xyXG5cclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnc2Nyb2xsJywgKCkgPT4ge1xyXG4gICAgICByZXNldFNjZW5lSW5kZXhGdW5jdGlvbigpO1xyXG4gICAgfSApO1xyXG5cclxuICAgIGlmICggaXNNb2JpbGVCcm93c2VyKCkgKSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5vdmVyZmxvd1ggPSAnYXV0byc7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnaGlkZGVuJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5vdmVyZmxvd1ggPSAnaGlkZGVuJztcclxuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLm92ZXJmbG93WSA9ICdoaWRkZW4nO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0dXBFbGVtZW50VmVydGljYWwoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdyb3cnO1xyXG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnNjcm9sbFNuYXBUeXBlID0gJ3kgbWFuZGF0b3J5JztcclxuXHJcbiAgICBjb25zdCByZXNldFNjZW5lSW5kZXhGdW5jdGlvbiA9IGRlYm91bmNlRmFjdG9yeSggKCkgPT4ge1xyXG4gICAgICB0aGlzLnNldEN1cnJlbnRTY2VuZUJ5SW5kZXgoIE1hdGgucm91bmQoIHRoaXMuZWxlbWVudC5zY3JvbGxUb3AgLyB3aW5kb3cuaW5uZXJIZWlnaHQgKSApXHJcbiAgICB9LCA1MDAgKTtcclxuXHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3Njcm9sbCcsICgpID0+IHtcclxuICAgICAgcmVzZXRTY2VuZUluZGV4RnVuY3Rpb24oKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBpZiAoIGlzTW9iaWxlQnJvd3NlcigpICkge1xyXG4gICAgICB0aGlzLmVsZW1lbnQuc3R5bGUub3ZlcmZsb3dYID0gJ2hpZGRlbic7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmVsZW1lbnQuc3R5bGUub3ZlcmZsb3dYID0gJ2hpZGRlbic7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5vdmVyZmxvd1kgPSAnaGlkZGVuJztcclxuICAgIH1cclxuICB9XHJcbn0iXSwibmFtZXMiOlsiSFRNTEVsZW1lbnQiLCJwcm90b3R5cGUiLCJyZW1vdmVBbGxDaGlsZHJlbiIsInRoaXMiLCJoYXNDaGlsZE5vZGVzIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwibWFrZUNvdmVyIiwic3R5bGUiLCJkaXNwbGF5Iiwid2lkdGgiLCJoZWlnaHQiLCJwb3NpdGlvbiIsInRvcCIsImxlZnQiLCJkaWN0S2V5c0J5QWN0aW9uIiwiTWFwIiwiaXNNb2JpbGVCcm93c2VyIiwidGVzdCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImRlYm91bmNlRmFjdG9yeSIsImZ1bmMiLCJkZWxheSIsImluRGVib3VuY2UiLCJjb250ZXh0Iiwid2luZG93IiwiYXJncyIsImFyZ3VtZW50cyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJhcHBseSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwYWlyIiwiY29kZSIsImZvckVhY2giLCJrYkV2ZW50IiwiTGF5ZXIiLCJlbGVtZW50IiwicHJpb3JpdHkiLCJiYWNrZ3JvdW5kU3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJmaWx0ZXIiLCJjbGFzc0xpc3QiLCJjdXJzb3IiLCJvbkNsaWNrIiwib25Nb3VzZU92ZXIiLCJvbk1vdXNlRG93biIsIm9uTW91c2VVcCIsImNvbnN0cnVjdG9yIiwiZ2V0TGF5ZXJFbGVtZW50Iiwic2V0UGFyZW50IiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwicGFyZW50RWxlbWVudCIsImlkIiwicGFyZW50SWQiLCJudW1MYXllcnMiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwibGVuZ3RoIiwiY2FwaXRhbGl6ZUZpcnN0TGV0dGVyIiwic2V0QXNNYWluTGF5ZXIiLCJsYXllciIsImxheWVyRGl2IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYWRkIiwiekluZGV4IiwidG9TdHJpbmciLCJiYWNrZ3JvdW5kIiwic2V0TGF5ZXJCYWNrZ3JvdW5kSW1hZ2UiLCJpbWFnZUVsZW1lbnQiLCJzcmMiLCJ1c2VyU2VsZWN0IiwibWF4V2lkdGgiLCJjbGFtcCIsIm51bSIsIm1pbiIsIm1heCIsIk1hdGgiLCJTY2VuZSIsImNvbnRhaW5lciIsImxheWVycyIsImNvbXBvbmVudHMiLCJtYWluTGF5ZXIiLCJtYWluTGF5ZXJDb25maWciLCJjIiwiYnVpbGQiLCJzZXR1cExheWVycyIsInNldEVsZW1lbnRTdHlsZSIsImFzeW5jIiwiZ2V0TWFpbkxheWVyIiwic2NlbmVDb3VudGVyIiwicXVlcnlTZWxlY3RvckFsbCIsImwiLCJmbGV4V3JhcCIsIm92ZXJmbG93IiwiU3RyaW5nIiwiaXNOdWxsT3JFbXB0eSIsInRydW5jYXRlIiwiZGVjb3JhdG9yIiwic3Vic3RyaW5nIiwicmVtb3ZlQWNjZW50cyIsIm5vcm1hbGl6ZSIsInJlcGxhY2UiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInplcm9CZWZvcmUiLCJwYWRTdGFydCIsIkNPTlZFUlNJT05fVU5JVCIsIkRJUkVDVElPTl9SRUZFUkVOQ0UiLCJWRVJUSUNBTF9SRUZFUkVOQ0UiLCJDT0xPUl9DSEFOTkVMIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJDb25jYXRlbmF0ZVNjZW5lIiwic2NlbmVzIiwiaW5kZXgiLCJjdXJyZW50U2NlbmVDbGFzc05hbWUiLCJkaXJlY3Rpb24iLCJjb25maWciLCJzdXBlciIsInNldHVwRWxlbWVudCIsInNldHVwU2NlbmVzIiwic2MiLCJwdXNoIiwiQXJyYXkiLCJpc0FycmF5IiwicHVzaFNjZW5lQnlDb25maWciLCJpc0ZpcnN0U2NlbmUiLCJpc0xhc3RTY2VuZSIsInByZXYiLCJnb1RvIiwibmV4dCIsInNldEN1cnJlbnRTY2VuZUJ5SW5kZXgiLCJIT1JJWk9OVEFMIiwic2Nyb2xsVG8iLCJpbm5lcldpZHRoIiwiYmVoYXZpb3IiLCJpbm5lckhlaWdodCIsImZyb20iLCJzIiwicmVtb3ZlIiwiZmxleCIsInNjcm9sbFNuYXBBbGlnbiIsInNjcm9sbEJlaGF2aW9yIiwic2V0dXBFbGVtZW50SG9yaXpvbnRhbCIsInNldHVwRWxlbWVudFZlcnRpY2FsIiwianVzdGlmeUNvbnRlbnQiLCJhbGlnbkl0ZW1zIiwiZmxleERpcmVjdGlvbiIsInNjcm9sbFNuYXBUeXBlIiwicmVzZXRTY2VuZUluZGV4RnVuY3Rpb24iLCJyb3VuZCIsInNjcm9sbExlZnQiLCJvdmVyZmxvd1giLCJvdmVyZmxvd1kiLCJzY3JvbGxUb3AiXSwic291cmNlUm9vdCI6IiJ9