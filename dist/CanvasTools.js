var CanvasTools;(()=>{"use strict";var t={173:(t,r,e)=>{e.d(r,{ColorRGBA:()=>o});var a=e(19);class o{r;g;b;a;constructor(t,r,e,o=1){this.r=(0,a.clamp)(t,0,255),this.g=(0,a.clamp)(r,0,255),this.b=(0,a.clamp)(e,0,255),this.a=(0,a.clamp)(o,0,255)}toString(){return`${this.r}, ${this.g}, ${this.b}, ${this.a}`}toStringWithoutAlpha(){return`${this.r}, ${this.g}, ${this.b}`}asArray({noAlpha:t=!1}={}){return t?[this.r,this.g,this.b]:[this.r,this.g,this.b,this.a]}getCopy(){return new o(this.r,this.g,this.b,this.a)}static increaseSaturation(t,r){r/=100;const e=Math.max(...t.asArray({noAlpha:!0})),o=t.getCopy();return o.r=Math.floor((0,a.clamp)(t.r===e?t.r+t.r*r:t.r-t.r*r,0,255)),o.g=Math.floor((0,a.clamp)(t.g===e?t.g+t.g*r:t.g-t.g*r,0,255)),o.b=Math.floor((0,a.clamp)(t.b===e?t.b+t.b*r:t.b-t.b*r,0,255)),o}static getUnique(t,r=!0){return t.filter(((t,r,e)=>e.findIndex((r=>JSON.stringify(t)===JSON.stringify(r)))===r)).filter((t=>!r||o.isValid(t)&&t.a>0))}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b,yield this.a}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}static isValid(t){return!("number"!=typeof t.r||Number.isNaN(t.r)||"number"!=typeof t.g||Number.isNaN(t.g)||"number"!=typeof t.b||Number.isNaN(t.b)||"number"!=typeof t.a||Number.isNaN(t.a))}static get BLACK(){return new o(0,0,0)}static get NULL(){return new o(0,0,0,0)}}},19:(t,r,e)=>{function a(t=0,r=0,e=100){return Math.max(r,Math.min(t,e))}e.d(r,{clamp:()=>a})},676:(t,r,e)=>{var a,o,n,i;e.d(r,{COLOR_CHANNEL:()=>i}),function(t){t[t.PIXEL=0]="PIXEL",t[t.PERCENTAGE=1]="PERCENTAGE"}(a||(a={})),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(o||(o={})),function(t){t[t.FROM_TOP=0]="FROM_TOP",t[t.FROM_BOTTOM=1]="FROM_BOTTOM"}(n||(n={})),function(t){t[t.R=0]="R",t[t.G=1]="G",t[t.B=2]="B",t[t.A=3]="A"}(i||(i={}))}},r={};function e(a){var o=r[a];if(void 0!==o)return o.exports;var n=r[a]={exports:{}};return t[a](n,n.exports,e),n.exports}e.d=(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},e.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};(()=>{e.r(a),e.d(a,{findBiggestColorRange:()=>s,getColorArrayByContext:()=>i,getColorPalette:()=>u,getColorPaletteByContext:()=>l,getPixelColorFromCanvas:()=>n,getPixelPositionByCanvasWidth:()=>o});var t=e(676),r=e(173);function o(t,r,e=4){return{x:t/e%r,y:Math.floor(Math.floor(t/r)/e)}}function n(t,e){return new r.ColorRGBA(e[t],e[t+1],e[t+2],e[t+3]/255)}function i(t,r=4){const e=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,a=[];for(var o=e.length;o>=0;o-=r)a.push(n(o,e));return a}function s(r){let e=Number.MAX_VALUE,a=Number.MAX_VALUE,o=Number.MAX_VALUE,n=Number.MIN_VALUE,i=Number.MIN_VALUE,s=Number.MIN_VALUE;r.forEach((t=>{e=Math.min(e,t.r),a=Math.min(a,t.g),o=Math.min(o,t.b),n=Math.max(n,t.r),i=Math.max(i,t.g),s=Math.max(s,t.b)}));const l=n-e,u=i-a,h=s-o,g=Math.max(l,u,h);return g===l?t.COLOR_CHANNEL.R:g===u?t.COLOR_CHANNEL.G:t.COLOR_CHANNEL.B}function l(t,r=0){return u(i(t),r)}function u(e,a=0){if(6===a||0===e.length){const t=e.reduce(((t,e)=>r.ColorRGBA.isValid(t)&&r.ColorRGBA.isValid(e)?(r.ColorRGBA.isValid(e)&&(t.r+=e.r,t.g+=e.g,t.b+=e.b,t.a+=e.a),t):r.ColorRGBA.NULL),r.ColorRGBA.NULL);return r.ColorRGBA.NULL.equals(t)?[r.ColorRGBA.NULL]:[new r.ColorRGBA(Math.round(t.r/e.length),Math.round(t.g/e.length),Math.round(t.b/e.length),Math.round(t.a/e.length))]}const o=s(e);e.sort(((r,e)=>{switch(o){case t.COLOR_CHANNEL.R:return r.r-e.r;case t.COLOR_CHANNEL.G:return r.g-e.g;case t.COLOR_CHANNEL.B:return r.b-e.b;default:return r.r-e.r}}));const n=e.length/2;return r.ColorRGBA.getUnique([...u(e.slice(0,n),a+1),...u(e.slice(n+1),a+1)].filter((t=>!t.equals(r.ColorRGBA.NULL))))}})(),CanvasTools=a})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUgsUUFDaENyRSxLQUFLZ0csTUFBT25HLEVBQU1aLEVBQUl1RixFQUFVSCxRQUNoQ3JFLEtBQUtnRyxNQUFPbkcsRUFBTVgsRUFBSXNGLEVBQVVILFFBQ2hDckUsS0FBS2dHLE1BQU9uRyxFQUFNVixFQUFJcUYsRUFBVUgsUyxDQVF0QyxNQUFNNEIsRUFBb0IxQixFQUF1QkMsR0FHakRBLEVBQVUwQixNQUFNLENBQUVDLEVBQUlDLEtBQ3BCLE9BQVNILEdBQ1AsS0FBSyxFQUFBcEUsY0FBYzBELEVBQ2pCLE9BQU9ZLEVBQUduSCxFQUFJb0gsRUFBR3BILEVBQ25CLEtBQUssRUFBQTZDLGNBQWMyRCxFQUNqQixPQUFPVyxFQUFHbEgsRUFBSW1ILEVBQUduSCxFQUNuQixLQUFLLEVBQUE0QyxjQUFjNEQsRUFDakIsT0FBT1UsRUFBR2pILEVBQUlrSCxFQUFHbEgsRUFDbkIsUUFDRSxPQUFPaUgsRUFBR25ILEVBQUlvSCxFQUFHcEgsRSxJQUt2QixNQUFNcUgsRUFBTTdCLEVBQVVILE9BQVMsRUFDL0IsT0FBTyxFQUFBdEYsVUFBVXFCLFVBQVcsSUFDdkJ3RixFQUFpQnBCLEVBQVU4QixNQUFPLEVBQUdELEdBQU9WLEVBQVEsTUFDcERDLEVBQWlCcEIsRUFBVThCLE1BQU9ELEVBQU0sR0FBS1YsRUFBUSxJQUN4RHBGLFFBQVFPLElBQU1BLEVBQUVJLE9BQVEsRUFBQW5DLFVBQVV3QyxRQUN0QyxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vQ29sb3JSR0JBLnRzIiwid2VicGFjazovLy8uL01hdGhUb29scy50cyIsIndlYnBhY2s6Ly8vLi90eXBlcy50cyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly8vLi9DYW52YXNUb29scy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjbGFtcCB9IGZyb20gJy4vTWF0aFRvb2xzJztcclxuaW1wb3J0IHsgQ29tcGFyYWJsZSB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIENvbG9yUkdCQSBpbXBsZW1lbnRzIENvbXBhcmFibGU8Q29sb3JSR0JBPiB7XHJcbiAgcHVibGljIHI6IG51bWJlcjtcclxuICBwdWJsaWMgZzogbnVtYmVyO1xyXG4gIHB1YmxpYyBiOiBudW1iZXI7XHJcbiAgcHVibGljIGE6IG51bWJlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoIHI6IG51bWJlciwgZzogbnVtYmVyLCBiOiBudW1iZXIsIGE6IG51bWJlciA9IDEgKSB7XHJcbiAgICB0aGlzLnIgPSBjbGFtcCggciwgMCwgMjU1ICk7XHJcbiAgICB0aGlzLmcgPSBjbGFtcCggZywgMCwgMjU1ICk7XHJcbiAgICB0aGlzLmIgPSBjbGFtcCggYiwgMCwgMjU1ICk7XHJcbiAgICB0aGlzLmEgPSBjbGFtcCggYSwgMCwgMjU1ICk7XHJcbiAgfVxyXG5cclxuICB0b1N0cmluZygpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGAkeyB0aGlzLnIgfSwgJHsgdGhpcy5nIH0sICR7IHRoaXMuYiB9LCAkeyB0aGlzLmEgfWA7XHJcbiAgfVxyXG5cclxuICB0b1N0cmluZ1dpdGhvdXRBbHBoYSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGAkeyB0aGlzLnIgfSwgJHsgdGhpcy5nIH0sICR7IHRoaXMuYiB9YDtcclxuICB9XHJcblxyXG4gIGFzQXJyYXkoIHsgbm9BbHBoYSA9IGZhbHNlIH06IHsgbm9BbHBoYT86IGJvb2xlYW47IH0gPSB7fSApOiBudW1iZXJbXSB7XHJcbiAgICBpZiAoIG5vQWxwaGEgKSB7XHJcbiAgICAgIHJldHVybiBbdGhpcy5yLCB0aGlzLmcsIHRoaXMuYl07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gW3RoaXMuciwgdGhpcy5nLCB0aGlzLmIsIHRoaXMuYV07XHJcbiAgfVxyXG5cclxuICBnZXRDb3B5KCkge1xyXG4gICAgcmV0dXJuIG5ldyBDb2xvclJHQkEoIHRoaXMuciwgdGhpcy5nLCB0aGlzLmIsIHRoaXMuYSApO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGluY3JlYXNlU2F0dXJhdGlvbiggY29sb3I6IENvbG9yUkdCQSwgcGVyY2VudGFnZTogbnVtYmVyICkge1xyXG4gICAgcGVyY2VudGFnZSA9IHBlcmNlbnRhZ2UgLyAxMDA7XHJcblxyXG4gICAgY29uc3QgbWF4VmFsdWUgPSBNYXRoLm1heCggLi4uY29sb3IuYXNBcnJheSggeyBub0FscGhhOiB0cnVlIH0gKSApO1xyXG4gICAgY29uc3QgY29weUNvbG9yID0gY29sb3IuZ2V0Q29weSgpO1xyXG5cclxuICAgIGNvcHlDb2xvci5yID0gTWF0aC5mbG9vciggY2xhbXAoIGNvbG9yLnIgPT09IG1heFZhbHVlID8gY29sb3IuciArICggY29sb3IuciAqIHBlcmNlbnRhZ2UgKSA6IGNvbG9yLnIgLSAoIGNvbG9yLnIgKiBwZXJjZW50YWdlICksIDAsIDI1NSApICk7XHJcbiAgICBjb3B5Q29sb3IuZyA9IE1hdGguZmxvb3IoIGNsYW1wKCBjb2xvci5nID09PSBtYXhWYWx1ZSA/IGNvbG9yLmcgKyAoIGNvbG9yLmcgKiBwZXJjZW50YWdlICkgOiBjb2xvci5nIC0gKCBjb2xvci5nICogcGVyY2VudGFnZSApLCAwLCAyNTUgKSApO1xyXG4gICAgY29weUNvbG9yLmIgPSBNYXRoLmZsb29yKCBjbGFtcCggY29sb3IuYiA9PT0gbWF4VmFsdWUgPyBjb2xvci5iICsgKCBjb2xvci5iICogcGVyY2VudGFnZSApIDogY29sb3IuYiAtICggY29sb3IuYiAqIHBlcmNlbnRhZ2UgKSwgMCwgMjU1ICkgKTtcclxuXHJcbiAgICByZXR1cm4gY29weUNvbG9yO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldFVuaXF1ZSggYXJyOiBDb2xvclJHQkFbXSwgcmVtb3ZlVHJhbnNwYXJlbnRQaXhlbHM6IGJvb2xlYW4gPSB0cnVlICkge1xyXG4gICAgcmV0dXJuIGFyclxyXG4gICAgICAuZmlsdGVyKCAoIHYsIGksIGEgKSA9PiBhLmZpbmRJbmRleCggdjIgPT4gKCBKU09OLnN0cmluZ2lmeSggdiApID09PSBKU09OLnN0cmluZ2lmeSggdjIgKSApICkgPT09IGkgKVxyXG4gICAgICAuZmlsdGVyKCBjID0+ICFyZW1vdmVUcmFuc3BhcmVudFBpeGVscyB8fCAoIENvbG9yUkdCQS5pc1ZhbGlkKCBjICkgJiYgYy5hID4gMCApICk7XHJcbiAgfVxyXG5cclxuICAqW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICB5aWVsZCB0aGlzLnI7XHJcbiAgICB5aWVsZCB0aGlzLmc7XHJcbiAgICB5aWVsZCB0aGlzLmI7XHJcbiAgICB5aWVsZCB0aGlzLmE7XHJcbiAgfVxyXG5cclxuICBlcXVhbHMoIGNvbG9yMjogQ29sb3JSR0JBICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuciA9PT0gY29sb3IyLnJcclxuICAgICAgJiYgdGhpcy5nID09PSBjb2xvcjIuZ1xyXG4gICAgICAmJiB0aGlzLmIgPT09IGNvbG9yMi5iXHJcbiAgICAgICYmIHRoaXMuYSA9PT0gY29sb3IyLmE7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgaXNWYWxpZCggY29sb3I6IENvbG9yUkdCQSApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0eXBlb2YgY29sb3IuciA9PT0gJ251bWJlcicgJiYgIU51bWJlci5pc05hTiggY29sb3IuciApXHJcbiAgICAgICYmIHR5cGVvZiBjb2xvci5nID09PSAnbnVtYmVyJyAmJiAhTnVtYmVyLmlzTmFOKCBjb2xvci5nIClcclxuICAgICAgJiYgdHlwZW9mIGNvbG9yLmIgPT09ICdudW1iZXInICYmICFOdW1iZXIuaXNOYU4oIGNvbG9yLmIgKVxyXG4gICAgICAmJiB0eXBlb2YgY29sb3IuYSA9PT0gJ251bWJlcicgJiYgIU51bWJlci5pc05hTiggY29sb3IuYSApO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldCBCTEFDSygpOiBDb2xvclJHQkEge1xyXG4gICAgcmV0dXJuIG5ldyBDb2xvclJHQkEoIDAsIDAsIDAgKTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXQgTlVMTCgpOiBDb2xvclJHQkEge1xyXG4gICAgcmV0dXJuIG5ldyBDb2xvclJHQkEoIDAsIDAsIDAsIDAgKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IHJlZ2V4TnVtYmVyUGF0dGVybiA9IC8tP1xcZCtcXC4/XFxkKi9nO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQb2ludDJEIHtcclxuICB4OiBudW1iZXI7XHJcbiAgeTogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERpbWVuc2lvbnMge1xyXG4gIHdpZHRoOiBudW1iZXI7XHJcbiAgaGVpZ2h0OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbmRleFRvUm93KCBpbmRleDogbnVtYmVyLCBncmlkV2lkdGg6IG51bWJlciApIHtcclxuICByZXR1cm4gTWF0aC5mbG9vciggaW5kZXggLyBncmlkV2lkdGggKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluZGV4VG9Db2woIGluZGV4OiBudW1iZXIsIGdyaWRXaWR0aDogbnVtYmVyICkge1xyXG4gIHJldHVybiBpbmRleCAlIGdyaWRXaWR0aDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJvd0NvbFRvSW5kZXgoIHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgd2lkdGg6IG51bWJlciApIHtcclxuICByZXR1cm4gKCByb3cgKiB3aWR0aCApICsgY29sO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxlcnAoIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciwgYW1vdW50OiBudW1iZXIgKTogbnVtYmVyIHtcclxuICByZXR1cm4gKCAxIC0gYW1vdW50ICkgKiBtaW4gKyBhbW91bnQgKiBtYXg7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnZlcnNlTGVycCggYTogbnVtYmVyLCBiOiBudW1iZXIsIHZhbDogbnVtYmVyICk6IG51bWJlciB7XHJcbiAgcmV0dXJuICggdmFsIC0gYSApIC8gKCBiIC0gYSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVtYXAoIGluTWluOiBudW1iZXIsIGluTWF4OiBudW1iZXIsIG91dE1pbjogbnVtYmVyLCBvdXRNYXg6IG51bWJlciwgdmFsOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICByZXR1cm4gbGVycCggb3V0TWluLCBvdXRNYXgsIGludmVyc2VMZXJwKCBpbk1pbiwgaW5NYXgsIHZhbCApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSYW5kb21JbnRFeGNsdXNpdmUoIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciApIHtcclxuICByZXR1cm4gTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqICggbWF4IC0gbWluICkgKyBtaW4gKTtcclxufVxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmFuZG9tSW50SW5jbHVzaXZlKCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIgKSB7XHJcbiAgbWluID0gTWF0aC5jZWlsKCBtaW4gKTtcclxuICBtYXggPSBNYXRoLmZsb29yKCBtYXggKTtcclxuICByZXR1cm4gTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqICggbWF4IC0gbWluICsgMSApICkgKyBtaW47XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSYW5kb21Gcm9tQXJyYXk8VD4oIGFycjogQXJyYXk8VD4gKSB7XHJcbiAgcmV0dXJuIGFycltnZXRSYW5kb21JbnRFeGNsdXNpdmUoIDAsIGFyci5sZW5ndGggKV07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCggbnVtOiBudW1iZXIgPSAwLCBtaW46IG51bWJlciA9IDAsIG1heDogbnVtYmVyID0gMTAwICk6IG51bWJlciB7XHJcbiAgcmV0dXJuIE1hdGgubWF4KCBtaW4sIE1hdGgubWluKCBudW0sIG1heCApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtaW51dGVzVG9NaWxsaXNlY29uZHMoIG1zOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIG1zICogNjAwMDA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtaWxsaXNlY29uZHNUb01pbnV0ZXMoIG1zOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIG1zIC8gNjAwMDA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtaWxsaXNlY29uZHNUb0hvdXJzKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBtcyAvIDMuNmUrNjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1pbGxpc2Vjb25kc1RvRGF5cyggbXM6IG51bWJlciApIHtcclxuICByZXR1cm4gbXMgLyA4LjY0ZSs3O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWVnYWJ5dGVUb0J5dGUoIG1iOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIG1iICogMTAyNCAqIDEwMjQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBieXRlVG9NZWdhYnl0ZSggYjogbnVtYmVyICkge1xyXG4gIHJldHVybiBiIC8gMTAyNCAvIDEwMjQ7XHJcbn0iLCJpbXBvcnQgeyBJUG9pbnQyRCB9IGZyb20gJy4vaW50ZXJmYWNlcyc7XHJcblxyXG5leHBvcnQgZW51bSBDT05WRVJTSU9OX1VOSVQgeyBQSVhFTCwgUEVSQ0VOVEFHRSB9XHJcbmV4cG9ydCBlbnVtIERJUkVDVElPTl9SRUZFUkVOQ0UgeyBIT1JJWk9OVEFMLCBWRVJUSUNBTCB9XHJcbmV4cG9ydCBlbnVtIFZFUlRJQ0FMX1JFRkVSRU5DRSB7IEZST01fVE9QLCBGUk9NX0JPVFRPTSB9XHJcblxyXG5leHBvcnQgZW51bSBDT0xPUl9DSEFOTkVMIHsgUiwgRywgQiwgQSB9O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb21wYXJhYmxlPFQ+IHtcclxuICBlcXVhbHMoIGI6IFQgKTogYm9vbGVhbjtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBDU1NQb3NpdGlvbiBpbXBsZW1lbnRzIElQb2ludDJEIHtcclxuICBwdWJsaWMgeDogbnVtYmVyO1xyXG4gIHB1YmxpYyB5OiBudW1iZXI7XHJcbiAgcHJpdmF0ZSB0eXBlOiBDT05WRVJTSU9OX1VOSVQ7XHJcbiAgcHVibGljIHZlcnRpY2FsUmVmZXJlbmNlOiBWRVJUSUNBTF9SRUZFUkVOQ0U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCB7IHgsIHksIHZlcnRpY2FsUmVmZXJlbmNlID0gVkVSVElDQUxfUkVGRVJFTkNFLkZST01fVE9QLCB0eXBlID0gQ09OVkVSU0lPTl9VTklULlBJWEVMIH06IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHZlcnRpY2FsUmVmZXJlbmNlPzogVkVSVElDQUxfUkVGRVJFTkNFOyB0eXBlPzogQ09OVkVSU0lPTl9VTklUOyB9ICkge1xyXG4gICAgW3RoaXMueCwgdGhpcy55LCB0aGlzLnZlcnRpY2FsUmVmZXJlbmNlLCB0aGlzLnR5cGVdID0gW3gsIHksIHZlcnRpY2FsUmVmZXJlbmNlLCB0eXBlXTtcclxuICB9XHJcblxyXG4gIGdldCBob3Jpem9udGFsKCk6IHN0cmluZyB7XHJcbiAgICBzd2l0Y2ggKCB0aGlzLnR5cGUgKSB7XHJcbiAgICAgIGNhc2UgQ09OVkVSU0lPTl9VTklULlBJWEVMOlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy54IH1weGA7XHJcbiAgICAgIGNhc2UgQ09OVkVSU0lPTl9VTklULlBFUkNFTlRBR0U6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnggfSVgO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy54IH1weGA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXQgdmVydGljYWwoKTogc3RyaW5nIHtcclxuICAgIHN3aXRjaCAoIHRoaXMudHlwZSApIHtcclxuICAgICAgY2FzZSBDT05WRVJTSU9OX1VOSVQuUElYRUw6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnkgfXB4YDtcclxuICAgICAgY2FzZSBDT05WRVJTSU9OX1VOSVQuUEVSQ0VOVEFHRTpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueSB9JWA7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnkgfXB4YDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIENvbGxpc2lvbkRpcmVjdGlvbkNoZWNrID0ge1xyXG4gIHRvcDogYm9vbGVhbjtcclxuICByaWdodDogYm9vbGVhbjtcclxuICBjZW50ZXI6IGJvb2xlYW47XHJcbiAgYm90dG9tOiBib29sZWFuO1xyXG4gIGxlZnQ6IGJvb2xlYW47XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSA9IHtcclxuICB0b3A6IG51bWJlcjtcclxuICByaWdodDogbnVtYmVyO1xyXG4gIGJvdHRvbTogbnVtYmVyO1xyXG4gIGxlZnQ6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQ29sbGlzaW9uRXZlbnQge1xyXG4gIHRhcmdldENsYXNzOiBzdHJpbmc7XHJcbiAgYXV0b0luc2VydFRhcmdldENsYXNzOiBib29sZWFuO1xyXG4gIG9uQ29sbGlkaW5nKCBkcmFnZ2FibGU6IEhUTUxFbGVtZW50LCB0YXJnZXQ6IEhUTUxFbGVtZW50LCBjb2xsaWRpbmdBdDogQ29sbGlzaW9uRGlyZWN0aW9uQ2hlY2ssIGRpc3RhbmNlRnJvbUJvcmRlcjogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgKTogUHJvbWlzZTx2b2lkPjtcclxuICBvbk5vdENvbGxpZGluZyggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCApOiBQcm9taXNlPHZvaWQ+O1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBDb2xsaXNpb25UcmlnZ2VyT3B0aW9ucyA9IHtcclxuICB0cmlnZ2VyRWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcbiAgZXZlbnRzOiBJQ29sbGlzaW9uRXZlbnRbXTtcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZUV4dHJhcyB7XHJcbiAgY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZTtcclxuXHJcbiAgY29uc3RydWN0b3IoIGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSApIHtcclxuICAgIHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzID0gY29sbGlzaW9uQm9yZGVyRGlzdGFuY2U7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYW55R3JlYXRlclRoYW4oIG51bTogbnVtYmVyICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLnRvcCA+IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5yaWdodCA+IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5ib3R0b20gPiBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMubGVmdCA+IG51bTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhbnlMb3dlclRoYW4oIG51bTogbnVtYmVyICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLnRvcCA8IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5yaWdodCA8IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5ib3R0b20gPCBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMubGVmdCA8IG51bTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhbnlFcXVhbHMoIG51bTogbnVtYmVyICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLnRvcCA9PT0gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLnJpZ2h0ID09PSBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMuYm90dG9tID09PSBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMubGVmdCA9PT0gbnVtO1xyXG4gIH1cclxufSIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0IHsgUG9pbnQyRCB9IGZyb20gJy4vTWF0aFRvb2xzJztcclxuaW1wb3J0IHsgQ09MT1JfQ0hBTk5FTCB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBDb2xvclJHQkEgfSBmcm9tIFwiLi9Db2xvclJHQkFcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQaXhlbFBvc2l0aW9uQnlDYW52YXNXaWR0aCggcGl4ZWxJbmRleDogbnVtYmVyLCBjYW52YXNXaWR0aDogbnVtYmVyLCBudW1iZXJPZkNvbG9yQ2hhbm5lbHM6IG51bWJlciA9IDQgKTogUG9pbnQyRCB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHg6ICggcGl4ZWxJbmRleCAvIG51bWJlck9mQ29sb3JDaGFubmVscyApICUgY2FudmFzV2lkdGgsXHJcbiAgICB5OiBNYXRoLmZsb29yKCBNYXRoLmZsb29yKCBwaXhlbEluZGV4IC8gY2FudmFzV2lkdGggKSAvIG51bWJlck9mQ29sb3JDaGFubmVscyApXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGl4ZWxDb2xvckZyb21DYW52YXMoIHBpeGVsSW5kZXg6IG51bWJlciwgcGl4ZWxBcnJheTogVWludDhDbGFtcGVkQXJyYXkgKTogQ29sb3JSR0JBIHtcclxuICByZXR1cm4gbmV3IENvbG9yUkdCQShcclxuICAgIHBpeGVsQXJyYXlbcGl4ZWxJbmRleF0sXHJcbiAgICBwaXhlbEFycmF5W3BpeGVsSW5kZXggKyAxXSxcclxuICAgIHBpeGVsQXJyYXlbcGl4ZWxJbmRleCArIDJdLFxyXG4gICAgcGl4ZWxBcnJheVtwaXhlbEluZGV4ICsgM10gLyAyNTUgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbG9yQXJyYXlCeUNvbnRleHQoIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgbnVtYmVyT2ZDb2xvckNoYW5uZWxzOiBudW1iZXIgPSA0ICk6IENvbG9yUkdCQVtdIHtcclxuICBjb25zdCBwaXhlbEFycmF5ID0gY29udGV4dFxyXG4gICAgLmdldEltYWdlRGF0YSggMCwgMCwgY29udGV4dC5jYW52YXMud2lkdGgsIGNvbnRleHQuY2FudmFzLmhlaWdodCApXHJcbiAgICAuZGF0YTtcclxuXHJcbiAgY29uc3QgY29sb3JBcnJheTogQ29sb3JSR0JBW10gPSBbXTtcclxuICBmb3IgKCB2YXIgaSA9IHBpeGVsQXJyYXkubGVuZ3RoOyBpID49IDA7IGkgLT0gbnVtYmVyT2ZDb2xvckNoYW5uZWxzICkge1xyXG4gICAgY29sb3JBcnJheS5wdXNoKCBnZXRQaXhlbENvbG9yRnJvbUNhbnZhcyggaSwgcGl4ZWxBcnJheSApICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gY29sb3JBcnJheTtcclxufVxyXG5cclxuLy8vIEZpbmQgdGhlIGNvbG9yIGNoYW5uZWwgKCByZWQsIGdyZWVuIG9yIGJsdWUpIGluIHRoZSBpbWFnZSB3aXRoIHRoZSBiaWdnZXN0IHJhbmdlXHJcbmV4cG9ydCBmdW5jdGlvbiBmaW5kQmlnZ2VzdENvbG9yUmFuZ2UoIHJnYlZhbHVlczogQ29sb3JSR0JBW10gKSB7XHJcbiAgbGV0IHJNaW4gPSBOdW1iZXIuTUFYX1ZBTFVFO1xyXG4gIGxldCBnTWluID0gTnVtYmVyLk1BWF9WQUxVRTtcclxuICBsZXQgYk1pbiA9IE51bWJlci5NQVhfVkFMVUU7XHJcblxyXG4gIGxldCByTWF4ID0gTnVtYmVyLk1JTl9WQUxVRTtcclxuICBsZXQgZ01heCA9IE51bWJlci5NSU5fVkFMVUU7XHJcbiAgbGV0IGJNYXggPSBOdW1iZXIuTUlOX1ZBTFVFO1xyXG5cclxuICByZ2JWYWx1ZXMuZm9yRWFjaCggKCBwaXhlbCApID0+IHtcclxuICAgIHJNaW4gPSBNYXRoLm1pbiggck1pbiwgcGl4ZWwuciApO1xyXG4gICAgZ01pbiA9IE1hdGgubWluKCBnTWluLCBwaXhlbC5nICk7XHJcbiAgICBiTWluID0gTWF0aC5taW4oIGJNaW4sIHBpeGVsLmIgKTtcclxuXHJcbiAgICByTWF4ID0gTWF0aC5tYXgoIHJNYXgsIHBpeGVsLnIgKTtcclxuICAgIGdNYXggPSBNYXRoLm1heCggZ01heCwgcGl4ZWwuZyApO1xyXG4gICAgYk1heCA9IE1hdGgubWF4KCBiTWF4LCBwaXhlbC5iICk7XHJcbiAgfSApO1xyXG5cclxuICBjb25zdCByUmFuZ2UgPSByTWF4IC0gck1pbjtcclxuICBjb25zdCBnUmFuZ2UgPSBnTWF4IC0gZ01pbjtcclxuICBjb25zdCBiUmFuZ2UgPSBiTWF4IC0gYk1pbjtcclxuXHJcbiAgY29uc3QgYmlnZ2VzdFJhbmdlID0gTWF0aC5tYXgoIHJSYW5nZSwgZ1JhbmdlLCBiUmFuZ2UgKTtcclxuICBpZiAoIGJpZ2dlc3RSYW5nZSA9PT0gclJhbmdlICkge1xyXG4gICAgcmV0dXJuIENPTE9SX0NIQU5ORUwuUjtcclxuICB9IGVsc2UgaWYgKCBiaWdnZXN0UmFuZ2UgPT09IGdSYW5nZSApIHtcclxuICAgIHJldHVybiBDT0xPUl9DSEFOTkVMLkc7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiBDT0xPUl9DSEFOTkVMLkI7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29sb3JQYWxldHRlQnlDb250ZXh0KCBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIGRlcHRoOiBudW1iZXIgPSAwICk6IENvbG9yUkdCQVtdIHtcclxuICByZXR1cm4gZ2V0Q29sb3JQYWxldHRlKCBnZXRDb2xvckFycmF5QnlDb250ZXh0KCBjb250ZXh0ICksIGRlcHRoICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2xvclBhbGV0dGUoIHJnYlZhbHVlczogQ29sb3JSR0JBW10sIGRlcHRoOiBudW1iZXIgPSAwICk6IENvbG9yUkdCQVtdIHtcclxuICAvLy8gVHJhbnNmb3JtYW5kbyBlc3NhIHBhcnRlIGRhIGFycmF5IGRlIGNvcmVzIGVtIHbDoXJpb3MgXCJyYW5nZXNcIiBkZSBjb3JlcyBkaWZlcmVudGVzXHJcbiAgY29uc3QgTUFYX0RFUFRIID0gNjtcclxuICBpZiAoIGRlcHRoID09PSBNQVhfREVQVEggfHwgcmdiVmFsdWVzLmxlbmd0aCA9PT0gMCApIHtcclxuICAgIGNvbnN0IGNvbG9yID0gcmdiVmFsdWVzLnJlZHVjZShcclxuICAgICAgKCBwcmV2LCBjdXJyICkgPT4ge1xyXG4gICAgICAgIGlmICggIUNvbG9yUkdCQS5pc1ZhbGlkKCBwcmV2ICkgfHwgIUNvbG9yUkdCQS5pc1ZhbGlkKCBjdXJyICkgKSB7XHJcbiAgICAgICAgICByZXR1cm4gQ29sb3JSR0JBLk5VTEw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIENvbG9yUkdCQS5pc1ZhbGlkKCBjdXJyICkgKSB7XHJcbiAgICAgICAgICBwcmV2LnIgKz0gY3Vyci5yO1xyXG4gICAgICAgICAgcHJldi5nICs9IGN1cnIuZztcclxuICAgICAgICAgIHByZXYuYiArPSBjdXJyLmI7XHJcbiAgICAgICAgICBwcmV2LmEgKz0gY3Vyci5hO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHByZXY7XHJcbiAgICAgIH0sXHJcbiAgICAgIENvbG9yUkdCQS5OVUxMXHJcbiAgICApO1xyXG4gICAgaWYgKCAhQ29sb3JSR0JBLk5VTEwuZXF1YWxzKCBjb2xvciApICkge1xyXG4gICAgICByZXR1cm4gW25ldyBDb2xvclJHQkEoXHJcbiAgICAgICAgTWF0aC5yb3VuZCggY29sb3IuciAvIHJnYlZhbHVlcy5sZW5ndGggKSxcclxuICAgICAgICBNYXRoLnJvdW5kKCBjb2xvci5nIC8gcmdiVmFsdWVzLmxlbmd0aCApLFxyXG4gICAgICAgIE1hdGgucm91bmQoIGNvbG9yLmIgLyByZ2JWYWx1ZXMubGVuZ3RoICksXHJcbiAgICAgICAgTWF0aC5yb3VuZCggY29sb3IuYSAvIHJnYlZhbHVlcy5sZW5ndGggKVxyXG4gICAgICApXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBbQ29sb3JSR0JBLk5VTExdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8vIEVuY29udHJhbmRvIG8gY2FuYWwgZGUgY29yIHF1ZSBtYWlzIGFwYXJlY2VcclxuICBjb25zdCBjb21wb25lbnRUb1NvcnRCeSA9IGZpbmRCaWdnZXN0Q29sb3JSYW5nZSggcmdiVmFsdWVzICk7XHJcblxyXG4gIC8vLyBPcmRlbmFuZG8gYSBhcnJheSBwZWxvIGNhbmFsIGRlIGNvciBwcmVkb21pbmFudGVcclxuICByZ2JWYWx1ZXMuc29ydCggKCBwMSwgcDIgKSA9PiB7XHJcbiAgICBzd2l0Y2ggKCBjb21wb25lbnRUb1NvcnRCeSApIHtcclxuICAgICAgY2FzZSBDT0xPUl9DSEFOTkVMLlI6XHJcbiAgICAgICAgcmV0dXJuIHAxLnIgLSBwMi5yXHJcbiAgICAgIGNhc2UgQ09MT1JfQ0hBTk5FTC5HOlxyXG4gICAgICAgIHJldHVybiBwMS5nIC0gcDIuZ1xyXG4gICAgICBjYXNlIENPTE9SX0NIQU5ORUwuQjpcclxuICAgICAgICByZXR1cm4gcDEuYiAtIHAyLmJcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gcDEuciAtIHAyLnJcclxuICAgIH1cclxuICB9ICk7XHJcblxyXG4gIC8vLyBEaXZpZGluZG8gYSBhcnJheSBlbSBkb2lzIGUgdXNhbmRvIHJlY3Vyc8OjbyBwYXJhIG1lbGhvcmFyIG8gZGVzZW1wZW5ob1xyXG4gIGNvbnN0IG1pZCA9IHJnYlZhbHVlcy5sZW5ndGggLyAyO1xyXG4gIHJldHVybiBDb2xvclJHQkEuZ2V0VW5pcXVlKCBbXHJcbiAgICAuLi5nZXRDb2xvclBhbGV0dGUoIHJnYlZhbHVlcy5zbGljZSggMCwgbWlkICksIGRlcHRoICsgMSApLFxyXG4gICAgLi4uZ2V0Q29sb3JQYWxldHRlKCByZ2JWYWx1ZXMuc2xpY2UoIG1pZCArIDEgKSwgZGVwdGggKyAxICksXHJcbiAgXS5maWx0ZXIoIGMgPT4gIWMuZXF1YWxzKCBDb2xvclJHQkEuTlVMTCApICkgKTtcclxufSJdLCJuYW1lcyI6WyJDb2xvclJHQkEiLCJyIiwiZyIsImIiLCJhIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiY2xhbXAiLCJ0b1N0cmluZyIsInRvU3RyaW5nV2l0aG91dEFscGhhIiwiYXNBcnJheSIsIm5vQWxwaGEiLCJnZXRDb3B5IiwiaW5jcmVhc2VTYXR1cmF0aW9uIiwiY29sb3IiLCJwZXJjZW50YWdlIiwibWF4VmFsdWUiLCJNYXRoIiwibWF4IiwiY29weUNvbG9yIiwiZmxvb3IiLCJnZXRVbmlxdWUiLCJhcnIiLCJyZW1vdmVUcmFuc3BhcmVudFBpeGVscyIsImZpbHRlciIsInYiLCJpIiwiZmluZEluZGV4IiwidjIiLCJKU09OIiwic3RyaW5naWZ5IiwiYyIsImlzVmFsaWQiLCJTeW1ib2wiLCJpdGVyYXRvciIsImVxdWFscyIsImNvbG9yMiIsIk51bWJlciIsImlzTmFOIiwiQkxBQ0siLCJOVUxMIiwibnVtIiwibWluIiwiQ09OVkVSU0lPTl9VTklUIiwiRElSRUNUSU9OX1JFRkVSRU5DRSIsIlZFUlRJQ0FMX1JFRkVSRU5DRSIsIkNPTE9SX0NIQU5ORUwiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiZ2V0UGl4ZWxQb3NpdGlvbkJ5Q2FudmFzV2lkdGgiLCJwaXhlbEluZGV4IiwiY2FudmFzV2lkdGgiLCJudW1iZXJPZkNvbG9yQ2hhbm5lbHMiLCJ4IiwieSIsImdldFBpeGVsQ29sb3JGcm9tQ2FudmFzIiwicGl4ZWxBcnJheSIsImdldENvbG9yQXJyYXlCeUNvbnRleHQiLCJjb250ZXh0IiwiZ2V0SW1hZ2VEYXRhIiwiY2FudmFzIiwid2lkdGgiLCJoZWlnaHQiLCJkYXRhIiwiY29sb3JBcnJheSIsImxlbmd0aCIsInB1c2giLCJmaW5kQmlnZ2VzdENvbG9yUmFuZ2UiLCJyZ2JWYWx1ZXMiLCJyTWluIiwiTUFYX1ZBTFVFIiwiZ01pbiIsImJNaW4iLCJyTWF4IiwiTUlOX1ZBTFVFIiwiZ01heCIsImJNYXgiLCJmb3JFYWNoIiwicGl4ZWwiLCJyUmFuZ2UiLCJnUmFuZ2UiLCJiUmFuZ2UiLCJiaWdnZXN0UmFuZ2UiLCJSIiwiRyIsIkIiLCJnZXRDb2xvclBhbGV0dGVCeUNvbnRleHQiLCJkZXB0aCIsImdldENvbG9yUGFsZXR0ZSIsInJlZHVjZSIsInByZXYiLCJjdXJyIiwicm91bmQiLCJjb21wb25lbnRUb1NvcnRCeSIsInNvcnQiLCJwMSIsInAyIiwibWlkIiwic2xpY2UiXSwic291cmNlUm9vdCI6IiJ9