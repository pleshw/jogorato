var DraggableAction;(()=>{"use strict";var t={28:(t,e,n)=>{n.d(e,{checkElementCollision:()=>i,getCollisionDirection:()=>r,getDistanceFromBorder:()=>s});const o=new Map;function i(t,e){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect();return!(n.top>o.bottom||n.right<o.left||n.bottom<o.top||n.left>o.right)}function r(t,e){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect();return{top:n.bottom>o.top&&n.top<o.top+o.height/3,right:n.left<o.right&&n.right>o.right-o.width/3,center:n.top<o.bottom&&n.bottom>o.top&&n.left<o.right&&n.right>o.left,bottom:n.top<o.bottom-o.height/3&&n.bottom>o.bottom-o.height/3,left:n.right>o.left&&n.left<o.left+o.width/3}}function s(t,e){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect(),i=n.left+n.width/2,r=n.top+n.height/2;return{top:r-o.top,right:o.right-i,bottom:o.bottom-r,left:i-o.left}}new Map,window.addEventListener("keydown",(t=>{for(const e of o)t.code===e[0]&&e[1].forEach((e=>e(t)))}))},676:(t,e,n)=>{var o,i,r,s;n.d(e,{CollisionBorderDistanceExtras:()=>l}),function(t){t[t.PIXEL=0]="PIXEL",t[t.PERCENTAGE=1]="PERCENTAGE"}(o||(o={})),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(i||(i={})),function(t){t[t.FROM_TOP=0]="FROM_TOP",t[t.FROM_BOTTOM=1]="FROM_BOTTOM"}(r||(r={})),function(t){t[t.R=0]="R",t[t.G=1]="G",t[t.B=2]="B",t[t.A=3]="A"}(s||(s={}));class l{collisionBorderDistances;constructor(t){this.collisionBorderDistances=t}anyGreaterThan(t){return this.collisionBorderDistances.top>t||this.collisionBorderDistances.right>t||this.collisionBorderDistances.bottom>t||this.collisionBorderDistances.left>t}anyLowerThan(t){return this.collisionBorderDistances.top<t||this.collisionBorderDistances.right<t||this.collisionBorderDistances.bottom<t||this.collisionBorderDistances.left<t}anyEquals(t){return this.collisionBorderDistances.top===t||this.collisionBorderDistances.right===t||this.collisionBorderDistances.bottom===t||this.collisionBorderDistances.left===t}}}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};(()=>{n.r(o),n.d(o,{cleanNotCollidingElementsAttributesAndClasses:()=>g,getElementsInteractingSet:()=>m,initCollisionCheckOn:()=>h,insertIntoEventCheckList:()=>c,isValidTargetToTriggerEvent:()=>f,mapElementsCollidingByTargets:()=>i,mapElementsTriggeringEventsByTarget:()=>s,mapTargetsCollidingByTriggerElement:()=>r,setCollisionClasses:()=>d});var t=n(28),e=n(676);const i=new Map,r=new Map,s=new Map;let l;const a=new Map;function c(t,e,n){const o=a.get(e);o?o.push({triggerElement:t,events:n}):a.set(e,[{triggerElement:t,events:n}])}function g(t,e,n,o){t.delete(e)&&0===t.size&&o.triggerElement.classList.remove("colliding"),n.delete(o.triggerElement)&&0===n.size&&e.classList.remove("colliding")}function d(t,e){t.triggerElement.classList.add("colliding"),e.classList.add("colliding")}function h(e,n,o){c(e,n,o),l||(a.forEach(((t,e)=>{!function(t,e){document.querySelectorAll(e).forEach((e=>{t.forEach((t=>{t.events.forEach((t=>{t.autoInsertTargetClass&&e.classList.add(t.targetClass)}))}))}))}(t,e)})),l=setInterval((()=>{a.forEach((async(e,n)=>{!function(e,n){e.forEach((async e=>{const o=function(t){return i.has(t)||i.set(t,new Set),i.get(t)}(e);n.forEach((async n=>{if(n.triggerElement===e)return;const i=(s=n.triggerElement,r.has(s)||r.set(s,new Set),r.get(s));var s;(0,t.checkElementCollision)(n.triggerElement,e)?(i.add(e),o.add(n.triggerElement),d(n,e),await async function(e,n){const o=(0,t.getCollisionDirection)(e.triggerElement,n),i=(0,t.getDistanceFromBorder)(e.triggerElement,n);await Promise.all(e.events.map((async t=>{await t.onColliding(e.triggerElement,n,o,i)})))}(n,e)):await async function(t,e,n,o){g(t,e,n,o),await Promise.all(o.events.map((async t=>{await t.onNotColliding(o.triggerElement,e)})))}(i,e,o,n)}))}))}(Array.from(document.querySelectorAll(n)),e)}))}),50))}function f(t,n,o){return!!t.classList.contains(n)&&(!o||!new e.CollisionBorderDistanceExtras(o.distanceFromBorder).anyLowerThan(o.distanceThreshold))}function m(t){return s.has(t)||s.set(t,new Set),s.get(t)}})(),DraggableAction=o})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUksRUFBQTdGLDhCQUErQjZGLEVBQWlCZixvQkFDdkR2RSxhQUFjc0YsRUFBaUJFLG1CQU10RSxDQUVPLFNBQVNDLEVBQTJCaEgsR0FLekMsT0FKTW9ELEVBQW9Db0MsSUFBS3hGLElBQzdDb0QsRUFBb0NXLElBQUsvRCxFQUFRLElBQUl5RixLQUdoRHJDLEVBQW9DWixJQUFLeEMsRUFDbEQsQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL0RPTVRvb2xzLnRzIiwid2VicGFjazovLy8uL3R5cGVzLnRzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovLy8uL0RyYWdnYWJsZUFjdGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2ludDJELCByZWdleE51bWJlclBhdHRlcm4gfSBmcm9tICcuL01hdGhUb29scyc7XHJcbmltcG9ydCB7IENvbGxpc2lvbkRpcmVjdGlvbkNoZWNrLCBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IHR5cGUgS2V5Ym9hcmRFdmVudENhbGxiYWNrID0gKCBldnQ6IEtleWJvYXJkRXZlbnQgKSA9PiB2b2lkO1xyXG5cclxuZXhwb3J0IGNvbnN0IGRpY3RLZXlzQnlBY3Rpb24gPSBuZXcgTWFwPHN0cmluZywgS2V5Ym9hcmRFdmVudENhbGxiYWNrW10+KCk7XHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRBY3Rpb25LZXkoIGtleTogc3RyaW5nLCBldmVudDogS2V5Ym9hcmRFdmVudENhbGxiYWNrICkge1xyXG4gIGlmICggZGljdEtleXNCeUFjdGlvbi5oYXMoIGtleSApICkge1xyXG4gICAgZGljdEtleXNCeUFjdGlvbi5zZXQoIGtleSwgW2V2ZW50LCAuLi5kaWN0S2V5c0J5QWN0aW9uLmdldCgga2V5ICkhXSApXHJcbiAgfSBlbHNlIHtcclxuICAgIGRpY3RLZXlzQnlBY3Rpb24uc2V0KCBrZXksIFtldmVudF0gKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrRWxlbWVudENvbGxpc2lvbiggZWxlbWVudDE6IEhUTUxFbGVtZW50LCBlbGVtZW50MjogSFRNTEVsZW1lbnQgKTogYm9vbGVhbiB7XHJcbiAgY29uc3QgcmVjdDEgPSBlbGVtZW50MS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICBjb25zdCByZWN0MiA9IGVsZW1lbnQyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICByZXR1cm4gIShcclxuICAgIHJlY3QxLnRvcCA+IHJlY3QyLmJvdHRvbSB8fFxyXG4gICAgcmVjdDEucmlnaHQgPCByZWN0Mi5sZWZ0IHx8XHJcbiAgICByZWN0MS5ib3R0b20gPCByZWN0Mi50b3AgfHxcclxuICAgIHJlY3QxLmxlZnQgPiByZWN0Mi5yaWdodFxyXG4gICk7XHJcbn1cclxuXHJcbi8vLyBHZXQgdGhlIGRlZmF1bHQgYXR0cmlidXRlcyBmcm9tIHRoZSB0YXJnZXQgZWxlbWVudFxyXG4vLy8gSWYgaGF2ZSBub3QgZGVmYXVsdCBhdHRyaWJ1dGUgd2l0aCB0aGlzIEBhdHRyaWJ1dGVOYW1lIG9uIG1hcCB3aWxsIHNldCB0aGUgY3VycmVudCBhdHRyaWJ1dGUgYXMgZGVmYXVsdFxyXG4vLy8gSWYgaGF2ZSBub3QgZGVmYXVsdCBhdHRyaWJ1dGUgd2l0aCB0aGlzIEBhdHRyaWJ1dGVOYW1lIHdpbGwgcmV0dXJuIGFuIGVtcHR5IHN0cmluZ1xyXG5leHBvcnQgY29uc3QgbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQgPSBuZXcgTWFwPEhUTUxFbGVtZW50LCBNYXA8c3RyaW5nLCBzdHJpbmc+PigpO1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdEF0dHJpYnV0ZUZvclRhcmdldCggdGFyZ2V0OiBIVE1MRWxlbWVudCwgYXR0cmlidXRlTmFtZTogc3RyaW5nICk6IHN0cmluZyB7XHJcbiAgaWYgKCAhbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuaGFzKCB0YXJnZXQgKSApIHtcclxuICAgIG1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LnNldCggdGFyZ2V0LCBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpICk7XHJcbiAgfVxyXG5cclxuICBsZXQgcmVzdWx0OiBzdHJpbmcgPSAnJztcclxuICBjb25zdCBkZWZhdWx0QXR0cmlidXRlVmFsdWVzQnlOYW1lID0gbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuZ2V0KCB0YXJnZXQgKSE7XHJcbiAgY29uc3QgdGFyZ2V0RGVmYXVsdEF0dHJpYnV0ZSA9ICFkZWZhdWx0QXR0cmlidXRlVmFsdWVzQnlOYW1lLmhhcyggYXR0cmlidXRlTmFtZSApID8gdGFyZ2V0LmdldEF0dHJpYnV0ZSggYXR0cmlidXRlTmFtZSApIDogZGVmYXVsdEF0dHJpYnV0ZVZhbHVlc0J5TmFtZS5nZXQoIGF0dHJpYnV0ZU5hbWUgKSE7XHJcblxyXG4gIHJlc3VsdCA9IHRhcmdldERlZmF1bHRBdHRyaWJ1dGUgPyB0YXJnZXREZWZhdWx0QXR0cmlidXRlIDogJyc7XHJcbiAgc2V0RGVmYXVsdEF0dHJpYnV0ZUZvclRhcmdldCggdGFyZ2V0LCBhdHRyaWJ1dGVOYW1lLCByZXN1bHQgKTtcclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldERlZmF1bHRBdHRyaWJ1dGVGb3JUYXJnZXQoIHRhcmdldDogSFRNTEVsZW1lbnQsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZywgbmV3RGVmYXVsdEF0dHJpYnV0ZTogc3RyaW5nICk6IHZvaWQge1xyXG4gIGlmICggIW1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LmhhcyggdGFyZ2V0ICkgKSB7XHJcbiAgICBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5zZXQoIHRhcmdldCwgbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKSApO1xyXG4gIH1cclxuXHJcbiAgbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuZ2V0KCB0YXJnZXQgKSEuc2V0KCBhdHRyaWJ1dGVOYW1lLCBuZXdEZWZhdWx0QXR0cmlidXRlICk7XHJcbn1cclxuXHJcbi8vLyBEaXZpZGUgbyBlbGVtZW50byBAdGFyZ2V0IGVtIDkgXCJxdWFkcmFkb3NcIiBpZ3VhaXMgZSByZXRvcm5hIGVtIHF1YWlzIHF1YWRyYWRvcyBvIGRyYWdnYWJsZSBlc3TDoSBjb2xpZGluZG8gY29tIG8gdGFyZ2V0XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2xsaXNpb25EaXJlY3Rpb24oIGRyYWdnYWJsZTogSFRNTEVsZW1lbnQsIHRhcmdldDogSFRNTEVsZW1lbnQgKTogQ29sbGlzaW9uRGlyZWN0aW9uQ2hlY2sge1xyXG4gIGNvbnN0IHJlY3QxID0gZHJhZ2dhYmxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gIGNvbnN0IHJlY3QyID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICBjb25zdCBpc1RvcCA9IHJlY3QxLmJvdHRvbSA+IHJlY3QyLnRvcCAmJiByZWN0MS50b3AgPCByZWN0Mi50b3AgKyByZWN0Mi5oZWlnaHQgLyAzO1xyXG4gIGNvbnN0IGlzUmlnaHQgPSByZWN0MS5sZWZ0IDwgcmVjdDIucmlnaHQgJiYgcmVjdDEucmlnaHQgPiByZWN0Mi5yaWdodCAtIHJlY3QyLndpZHRoIC8gMztcclxuICBjb25zdCBpc0NlbnRlciA9IHJlY3QxLnRvcCA8IHJlY3QyLmJvdHRvbSAmJiByZWN0MS5ib3R0b20gPiByZWN0Mi50b3AgJiYgcmVjdDEubGVmdCA8IHJlY3QyLnJpZ2h0ICYmIHJlY3QxLnJpZ2h0ID4gcmVjdDIubGVmdDtcclxuICBjb25zdCBpc0JvdHRvbSA9IHJlY3QxLnRvcCA8IHJlY3QyLmJvdHRvbSAtIHJlY3QyLmhlaWdodCAvIDMgJiYgcmVjdDEuYm90dG9tID4gcmVjdDIuYm90dG9tIC0gcmVjdDIuaGVpZ2h0IC8gMztcclxuICBjb25zdCBpc0xlZnQgPSByZWN0MS5yaWdodCA+IHJlY3QyLmxlZnQgJiYgcmVjdDEubGVmdCA8IHJlY3QyLmxlZnQgKyByZWN0Mi53aWR0aCAvIDM7XHJcblxyXG4gIHJldHVybiB7IHRvcDogaXNUb3AsIHJpZ2h0OiBpc1JpZ2h0LCBjZW50ZXI6IGlzQ2VudGVyLCBib3R0b206IGlzQm90dG9tLCBsZWZ0OiBpc0xlZnQgfTtcclxufVxyXG5cclxuLy8vIHJldHVybiB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgY2VudGVyIG9mIHRoZSBkcmFnZ2FibGUgdG8gdGhlIGNlbnRlciBvZiB0aGUgdGFyZ2V0IGVsZW1lbnQgZnJvbSBlYWNoIGJvcmRlciBcclxuZXhwb3J0IGZ1bmN0aW9uIGdldERpc3RhbmNlRnJvbUJvcmRlciggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCApOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSB7XHJcbiAgY29uc3QgcmVjdDEgPSBkcmFnZ2FibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgY29uc3QgcmVjdDIgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gIGNvbnN0IGNlbnRlciA9IHtcclxuICAgIHg6IHJlY3QxLmxlZnQgKyByZWN0MS53aWR0aCAvIDIsXHJcbiAgICB5OiByZWN0MS50b3AgKyByZWN0MS5oZWlnaHQgLyAyLFxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGRpc3RhbmNlRnJvbUJvcmRlcjogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgPSB7XHJcbiAgICB0b3A6IGNlbnRlci55IC0gcmVjdDIudG9wLFxyXG4gICAgcmlnaHQ6IHJlY3QyLnJpZ2h0IC0gY2VudGVyLngsXHJcbiAgICBib3R0b206IHJlY3QyLmJvdHRvbSAtIGNlbnRlci55LFxyXG4gICAgbGVmdDogY2VudGVyLnggLSByZWN0Mi5sZWZ0LFxyXG4gIH07XHJcblxyXG4gIHJldHVybiBkaXN0YW5jZUZyb21Cb3JkZXI7XHJcbn1cclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIGV2dCA9PiB7XHJcbiAgZm9yICggY29uc3QgcGFpciBvZiBkaWN0S2V5c0J5QWN0aW9uICkge1xyXG4gICAgaWYgKCBldnQuY29kZSA9PT0gcGFpclswXSApIHtcclxuICAgICAgcGFpclsxXS5mb3JFYWNoKCBrYkV2ZW50ID0+IGtiRXZlbnQoIGV2dCApICk7XHJcbiAgICB9XHJcbiAgfVxyXG59ICk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VHJhbnNmb3JtQ29vcmRzRnJvbUVsZW1lbnQoIGVsZW1lbnQ6IEhUTUxFbGVtZW50ICk6IFBvaW50MkQge1xyXG4gIGNvbnN0IGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlID0gKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZWxlbWVudCApLnRyYW5zZm9ybS5tYXRjaCggcmVnZXhOdW1iZXJQYXR0ZXJuICkgPz8gWzAsIDBdICkubWFwKCBuID0+ICtuICk7XHJcbiAgcmV0dXJuIHtcclxuICAgIHg6IGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlWzRdICE9PSB1bmRlZmluZWQgPyBNYXRoLnJvdW5kKCBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZVs0XSApIDogMCxcclxuICAgIHk6IGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlWzVdICE9PSB1bmRlZmluZWQgPyBNYXRoLnJvdW5kKCBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZVs1XSApIDogMFxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsaWNrRXZlbnRUb0Nvb3JkaW5hdGVzKCBldmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQgKSB7XHJcbiAgaWYgKCBldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiBldmVudC5jbGllbnRYLFxyXG4gICAgICB5OiBldmVudC5jbGllbnRZXHJcbiAgICB9O1xyXG4gIH0gZWxzZSBpZiAoIGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCApIHtcclxuICAgIGNvbnN0IHRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB0b3VjaC5jbGllbnRYLFxyXG4gICAgICB5OiB0b3VjaC5jbGllbnRZXHJcbiAgICB9O1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBcIkV2ZW50IG5vdCBGb3VuZFwiO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhpZGVFbGVtZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCApIHtcclxuICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gIGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gIGVsZW1lbnQuc3R5bGUuekluZGV4ID0gJy0xJztcclxuICBlbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAnMCc7XHJcbiAgZWxlbWVudC5zdHlsZS53aWR0aCA9ICcwcHggIWltcG9ydGFudCc7XHJcbiAgZWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMHB4ICFpbXBvcnRhbnQnO1xyXG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKCAnaGlkZGVuJywgJycgKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNsZWVwQXN5bmMoIG1zOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KCAoIHJlc29sdmUgKSA9PiBzZXRUaW1lb3V0KCAoKSA9PiByZXNvbHZlKCksIG1zICkgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRFbGVtZW50c0J5Q2hlY2soIHRyaWdnZXJFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LCB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudCwgb25DaGVjazogRnVuY3Rpb24sIG9uVW5jaGVjazogRnVuY3Rpb24gKSB7XHJcbiAgaWYgKCB0cmlnZ2VyRWxlbWVudC5jaGVja2VkICkge1xyXG4gICAgb25DaGVjayggdGFyZ2V0RWxlbWVudCApO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdHJpZ2dlckdyb3VwID0gdHJpZ2dlckVsZW1lbnQubmFtZVxyXG4gICAgPyBBcnJheS5mcm9tKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCBgW25hbWU9XCIkeyB0cmlnZ2VyRWxlbWVudC5uYW1lIH1cIl1gICkgKVxyXG4gICAgOiBbdHJpZ2dlckVsZW1lbnRdO1xyXG5cclxuICB0cmlnZ2VyR3JvdXAuZm9yRWFjaCggdCA9PiB0LmFkZEV2ZW50TGlzdGVuZXIoICdjaGFuZ2UnLCBldnQgPT4ge1xyXG4gICAgaWYgKCB0cmlnZ2VyRWxlbWVudC5jaGVja2VkICkge1xyXG4gICAgICBvbkNoZWNrKCB0YXJnZXRFbGVtZW50LCBldnQgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG9uVW5jaGVjayggdGFyZ2V0RWxlbWVudCwgZXZ0ICk7XHJcbiAgICB9XHJcbiAgfSApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc01vYmlsZUJyb3dzZXIoKSB7XHJcbiAgcmV0dXJuIC9BbmRyb2lkfGlQaG9uZS9pLnRlc3QoIG5hdmlnYXRvci51c2VyQWdlbnQgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzT25TY3JlZW4oIGVsZW1lbnQ6IEhUTUxFbGVtZW50ICkge1xyXG4gIGNvbnN0IHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gIHJldHVybiAoXHJcbiAgICByZWN0LnRvcCA+PSAwICYmXHJcbiAgICByZWN0LmxlZnQgPj0gMCAmJlxyXG4gICAgcmVjdC5ib3R0b20gPD0gKCB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCApICYmXHJcbiAgICByZWN0LnJpZ2h0IDw9ICggd2luZG93LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIClcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYmluZEVsZW1lbnRWaWV3SWZDaGVja2VkKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgb3B0aW9ucyA9IHtcclxuICBvbkNoZWNrOiAoIHRyaWdnZXJFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LCB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudCApID0+IHsgfSxcclxuICBvblVuY2hlY2s6ICggdHJpZ2dlckVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIHRhcmdldEVsZW1lbnQ6IEhUTUxFbGVtZW50ICkgPT4geyB9XHJcbn0gKSB7XHJcbiAgYmluZEVsZW1lbnRzQnlDaGVjayhcclxuICAgIHRyaWdnZXJFbGVtZW50LFxyXG4gICAgdGFyZ2V0RWxlbWVudCxcclxuICAgICggZWw6IEhUTUxFbGVtZW50ICkgPT4ge1xyXG4gICAgICBlbC5jbGFzc0xpc3QuYWRkKCAnc2hvdycgKTtcclxuICAgICAgb3B0aW9ucy5vbkNoZWNrKCB0cmlnZ2VyRWxlbWVudCwgdGFyZ2V0RWxlbWVudCApO1xyXG4gICAgfSxcclxuICAgICggZWw6IEhUTUxFbGVtZW50ICkgPT4ge1xyXG4gICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCAnc2hvdycgKTtcclxuICAgICAgb3B0aW9ucy5vblVuY2hlY2soIHRyaWdnZXJFbGVtZW50LCB0YXJnZXRFbGVtZW50ICk7XHJcbiAgICB9LFxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRWYWx1ZUZyb21SYWRpb0dyb3VwKCBncm91cE5hbWU6IHN0cmluZyApOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvciggYFtuYW1lPSR7IGdyb3VwTmFtZSB9XTpjaGVja2VkYCApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgaWYgKCBlbCApIHtcclxuICAgIHJldHVybiBlbC52YWx1ZTtcclxuICB9XHJcbn1cclxuXHJcblxyXG4vLyBSZXRvcm5hIHVtYSBmdW7Dp8OjbyBxdWUgbsOjbyB2YWkgc2VyIGNvbXBsZXRhZGEgY2FzbyBzZWphIGNoYW1hZGEgbm92YW1lbnRlIGVtIHsgZGVsYXkgfSBtaWxpc3NlZ3VuZG9zXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZUZhY3RvcnkoIGZ1bmM6IEZ1bmN0aW9uLCBkZWxheTogbnVtYmVyICk6IEZ1bmN0aW9uIHtcclxuICBsZXQgaW5EZWJvdW5jZTogbnVtYmVyO1xyXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gd2luZG93O1xyXG4gICAgY29uc3QgYXJncyA9IGFyZ3VtZW50cztcclxuICAgIGNsZWFyVGltZW91dCggaW5EZWJvdW5jZSApO1xyXG4gICAgaW5EZWJvdW5jZSA9IHdpbmRvdy5zZXRUaW1lb3V0KCAoKSA9PiBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICksIGRlbGF5ICk7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gUmV0b3JuYSB1bWEgZnVuw6fDo28gcXVlIHPDsyBwb2RlIHNlciBjb21wbGV0YWRhIHVtYSB2ZXogYSBjYWRhIHsgbGltaXQgfSBtaWxpc3NlZ3VuZG9zIFxyXG5leHBvcnQgZnVuY3Rpb24gdGhyb3R0bGVGYWN0b3J5KCBmdW5jOiBGdW5jdGlvbiwgbGltaXQ6IG51bWJlciApOiBGdW5jdGlvbiB7XHJcbiAgbGV0IGxhc3RGdW5jOiBudW1iZXI7XHJcbiAgbGV0IGxhc3RSYW46IG51bWJlcjtcclxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgY29udGV4dCA9IHdpbmRvdztcclxuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICBpZiAoICFsYXN0UmFuICkge1xyXG4gICAgICBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICk7XHJcbiAgICAgIGxhc3RSYW4gPSBEYXRlLm5vdygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KCBsYXN0RnVuYyApO1xyXG4gICAgICBsYXN0RnVuYyA9IHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCBEYXRlLm5vdygpIC0gbGFzdFJhbiA+PSBsaW1pdCApIHtcclxuICAgICAgICAgIGZ1bmMuYXBwbHkoIGNvbnRleHQsIGFyZ3MgKTtcclxuICAgICAgICAgIGxhc3RSYW4gPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgbGltaXQgLSAoIERhdGUubm93KCkgLSBsYXN0UmFuICkgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzbW9vdGhTY3JvbGxUbyggcG9zOiBudW1iZXIgKTogdm9pZCB7XHJcbiAgd2luZG93LnNjcm9sbFRvKCB7XHJcbiAgICB0b3A6IHBvcyxcclxuICAgIGJlaGF2aW9yOiAnc21vb3RoJyxcclxuICB9ICk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0T3B0aW9uQnlUZXh0KCBpZFNlbGVjdEVsZW1lbnQ6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nLCBjb250YWluczogYm9vbGVhbiA9IGZhbHNlICk6IHZvaWQge1xyXG4gIGNvbnN0IHNlbGVjdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggaWRTZWxlY3RFbGVtZW50ICkgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcblxyXG4gIGlmICggIXNlbGVjdEVsZW1lbnQgKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjb25zdCBvcHRpb25zRWxlbWVudG9TZWxlY3QgPSBbLi4uc2VsZWN0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCAnb3B0aW9uJyApXTtcclxuXHJcbiAgbGV0IHNlbGVjdGVkT3B0aW9uO1xyXG4gIGlmICggY29udGFpbnMgKSB7XHJcbiAgICBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNFbGVtZW50b1NlbGVjdFxyXG4gICAgICAuZmlsdGVyKCBlbCA9PiBlbC50ZXh0Q29udGVudCAmJiBlbC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkgKSApWzBdLnZhbHVlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNFbGVtZW50b1NlbGVjdFxyXG4gICAgICAuZmlsdGVyKCBlbCA9PiBlbC50ZXh0Q29udGVudCAmJiBlbC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpID09PSBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkgKVswXS52YWx1ZTtcclxuICB9XHJcblxyXG4gIHNlbGVjdEVsZW1lbnQudmFsdWUgPSBzZWxlY3RlZE9wdGlvbjtcclxufVxyXG5cclxuIiwiaW1wb3J0IHsgSVBvaW50MkQgfSBmcm9tICcuL2ludGVyZmFjZXMnO1xyXG5cclxuZXhwb3J0IGVudW0gQ09OVkVSU0lPTl9VTklUIHsgUElYRUwsIFBFUkNFTlRBR0UgfVxyXG5leHBvcnQgZW51bSBESVJFQ1RJT05fUkVGRVJFTkNFIHsgSE9SSVpPTlRBTCwgVkVSVElDQUwgfVxyXG5leHBvcnQgZW51bSBWRVJUSUNBTF9SRUZFUkVOQ0UgeyBGUk9NX1RPUCwgRlJPTV9CT1RUT00gfVxyXG5cclxuZXhwb3J0IGVudW0gQ09MT1JfQ0hBTk5FTCB7IFIsIEcsIEIsIEEgfTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGFyYWJsZTxUPiB7XHJcbiAgZXF1YWxzKCBiOiBUICk6IGJvb2xlYW47XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQ1NTUG9zaXRpb24gaW1wbGVtZW50cyBJUG9pbnQyRCB7XHJcbiAgcHVibGljIHg6IG51bWJlcjtcclxuICBwdWJsaWMgeTogbnVtYmVyO1xyXG4gIHByaXZhdGUgdHlwZTogQ09OVkVSU0lPTl9VTklUO1xyXG4gIHB1YmxpYyB2ZXJ0aWNhbFJlZmVyZW5jZTogVkVSVElDQUxfUkVGRVJFTkNFO1xyXG5cclxuICBjb25zdHJ1Y3RvciggeyB4LCB5LCB2ZXJ0aWNhbFJlZmVyZW5jZSA9IFZFUlRJQ0FMX1JFRkVSRU5DRS5GUk9NX1RPUCwgdHlwZSA9IENPTlZFUlNJT05fVU5JVC5QSVhFTCB9OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB2ZXJ0aWNhbFJlZmVyZW5jZT86IFZFUlRJQ0FMX1JFRkVSRU5DRTsgdHlwZT86IENPTlZFUlNJT05fVU5JVDsgfSApIHtcclxuICAgIFt0aGlzLngsIHRoaXMueSwgdGhpcy52ZXJ0aWNhbFJlZmVyZW5jZSwgdGhpcy50eXBlXSA9IFt4LCB5LCB2ZXJ0aWNhbFJlZmVyZW5jZSwgdHlwZV07XHJcbiAgfVxyXG5cclxuICBnZXQgaG9yaXpvbnRhbCgpOiBzdHJpbmcge1xyXG4gICAgc3dpdGNoICggdGhpcy50eXBlICkge1xyXG4gICAgICBjYXNlIENPTlZFUlNJT05fVU5JVC5QSVhFTDpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueCB9cHhgO1xyXG4gICAgICBjYXNlIENPTlZFUlNJT05fVU5JVC5QRVJDRU5UQUdFOlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy54IH0lYDtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueCB9cHhgO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0IHZlcnRpY2FsKCk6IHN0cmluZyB7XHJcbiAgICBzd2l0Y2ggKCB0aGlzLnR5cGUgKSB7XHJcbiAgICAgIGNhc2UgQ09OVkVSU0lPTl9VTklULlBJWEVMOlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy55IH1weGA7XHJcbiAgICAgIGNhc2UgQ09OVkVSU0lPTl9VTklULlBFUkNFTlRBR0U6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnkgfSVgO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy55IH1weGA7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBDb2xsaXNpb25EaXJlY3Rpb25DaGVjayA9IHtcclxuICB0b3A6IGJvb2xlYW47XHJcbiAgcmlnaHQ6IGJvb2xlYW47XHJcbiAgY2VudGVyOiBib29sZWFuO1xyXG4gIGJvdHRvbTogYm9vbGVhbjtcclxuICBsZWZ0OiBib29sZWFuO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgPSB7XHJcbiAgdG9wOiBudW1iZXI7XHJcbiAgcmlnaHQ6IG51bWJlcjtcclxuICBib3R0b206IG51bWJlcjtcclxuICBsZWZ0OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUNvbGxpc2lvbkV2ZW50IHtcclxuICB0YXJnZXRDbGFzczogc3RyaW5nO1xyXG4gIGF1dG9JbnNlcnRUYXJnZXRDbGFzczogYm9vbGVhbjtcclxuICBvbkNvbGxpZGluZyggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCwgY29sbGlkaW5nQXQ6IENvbGxpc2lvbkRpcmVjdGlvbkNoZWNrLCBkaXN0YW5jZUZyb21Cb3JkZXI6IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlICk6IFByb21pc2U8dm9pZD47XHJcbiAgb25Ob3RDb2xsaWRpbmcoIGRyYWdnYWJsZTogSFRNTEVsZW1lbnQsIHRhcmdldDogSFRNTEVsZW1lbnQgKTogUHJvbWlzZTx2b2lkPjtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgQ29sbGlzaW9uVHJpZ2dlck9wdGlvbnMgPSB7XHJcbiAgdHJpZ2dlckVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gIGV2ZW50czogSUNvbGxpc2lvbkV2ZW50W107XHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2VFeHRyYXMge1xyXG4gIGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlczogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCBjb2xsaXNpb25Cb3JkZXJEaXN0YW5jZTogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgKSB7XHJcbiAgICB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcyA9IGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFueUdyZWF0ZXJUaGFuKCBudW06IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy50b3AgPiBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMucmlnaHQgPiBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMuYm90dG9tID4gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmxlZnQgPiBudW07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYW55TG93ZXJUaGFuKCBudW06IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy50b3AgPCBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMucmlnaHQgPCBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMuYm90dG9tIDwgbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmxlZnQgPCBudW07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYW55RXF1YWxzKCBudW06IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy50b3AgPT09IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5yaWdodCA9PT0gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmJvdHRvbSA9PT0gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmxlZnQgPT09IG51bTtcclxuICB9XHJcbn0iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IGNoZWNrRWxlbWVudENvbGxpc2lvbiwgZ2V0Q29sbGlzaW9uRGlyZWN0aW9uLCBnZXREZWZhdWx0QXR0cmlidXRlRm9yVGFyZ2V0LCBnZXREaXN0YW5jZUZyb21Cb3JkZXIgfSBmcm9tICcuL0RPTVRvb2xzJztcclxuaW1wb3J0IHsgQ29sbGlzaW9uVHJpZ2dlck9wdGlvbnMgYXMgQ29sbGlzaW9uVHJpZ2dlciwgQ29sbGlzaW9uRGlyZWN0aW9uQ2hlY2ssIENvbGxpc2lvbkJvcmRlckRpc3RhbmNlLCBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZUV4dHJhcywgSUNvbGxpc2lvbkV2ZW50IH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5leHBvcnQgY29uc3QgbWFwRWxlbWVudHNDb2xsaWRpbmdCeVRhcmdldHMgPSBuZXcgTWFwPEhUTUxFbGVtZW50LCBTZXQ8SFRNTEVsZW1lbnQ+PigpO1xyXG5leHBvcnQgY29uc3QgbWFwVGFyZ2V0c0NvbGxpZGluZ0J5VHJpZ2dlckVsZW1lbnQgPSBuZXcgTWFwPEhUTUxFbGVtZW50LCBTZXQ8SFRNTEVsZW1lbnQ+PigpO1xyXG5leHBvcnQgY29uc3QgbWFwRWxlbWVudHNUcmlnZ2VyaW5nRXZlbnRzQnlUYXJnZXQgPSBuZXcgTWFwPEhUTUxFbGVtZW50LCBTZXQ8SFRNTEVsZW1lbnQ+PigpO1xyXG5cclxubGV0IGNvbGxpc2lvbkNoZWNrSW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0O1xyXG5jb25zdCBjb2xsaXNpb25FdmVudHNCeVNlbGVjdG9ycyA9IG5ldyBNYXA8c3RyaW5nLCBDb2xsaXNpb25UcmlnZ2VyW10+KCk7XHJcblxyXG5cclxuLy8vIHB1c2ggZXZlbnRzIHRvIGEgZGljdGlvbmFyeSBhbmQgaWYgdGhleSBleGlzdCBqdXN0IGFkZCBuZXcgdGFyZ2V0cyB0byB0aGVtXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRJbnRvRXZlbnRDaGVja0xpc3QoIGVsZW1lbnRUb0NoZWNrOiBIVE1MRWxlbWVudCwgdGFyZ2V0UXVlcnlTZWxlY3Rvcjogc3RyaW5nLCBjb2xsaXNpb25FdmVudHM6IElDb2xsaXNpb25FdmVudFtdICkge1xyXG4gIGNvbnN0IHJlZkV4aXN0aW5nRXZlbnQ6IENvbGxpc2lvblRyaWdnZXJbXSB8IHVuZGVmaW5lZCA9IGNvbGxpc2lvbkV2ZW50c0J5U2VsZWN0b3JzLmdldCggdGFyZ2V0UXVlcnlTZWxlY3RvciApO1xyXG4gIGlmICggcmVmRXhpc3RpbmdFdmVudCApIHtcclxuICAgIHJlZkV4aXN0aW5nRXZlbnQucHVzaCgge1xyXG4gICAgICB0cmlnZ2VyRWxlbWVudDogZWxlbWVudFRvQ2hlY2ssXHJcbiAgICAgIGV2ZW50czogY29sbGlzaW9uRXZlbnRzXHJcbiAgICB9ICk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbGxpc2lvbkV2ZW50c0J5U2VsZWN0b3JzLnNldCggdGFyZ2V0UXVlcnlTZWxlY3RvciwgW3tcclxuICAgICAgdHJpZ2dlckVsZW1lbnQ6IGVsZW1lbnRUb0NoZWNrLFxyXG4gICAgICBldmVudHM6IGNvbGxpc2lvbkV2ZW50c1xyXG4gICAgfV0gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhbk5vdENvbGxpZGluZ0VsZW1lbnRzQXR0cmlidXRlc0FuZENsYXNzZXMoIHRyaWdnZXJFbGVtZW50c0NvbGxpc2lvbjogU2V0PEhUTUxFbGVtZW50PiwgdGFyZ2V0OiBIVE1MRWxlbWVudCwgdGFyZ2V0Q29sbGlzaW9uOiBTZXQ8SFRNTEVsZW1lbnQ+LCBhZ2VudDogQ29sbGlzaW9uVHJpZ2dlciApIHtcclxuICBpZiAoIHRyaWdnZXJFbGVtZW50c0NvbGxpc2lvbi5kZWxldGUoIHRhcmdldCBhcyBIVE1MRWxlbWVudCApICYmIHRyaWdnZXJFbGVtZW50c0NvbGxpc2lvbi5zaXplID09PSAwICkge1xyXG4gICAgYWdlbnQudHJpZ2dlckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSggJ2NvbGxpZGluZycgKTtcclxuICB9XHJcblxyXG4gIGlmICggdGFyZ2V0Q29sbGlzaW9uLmRlbGV0ZSggYWdlbnQudHJpZ2dlckVsZW1lbnQgKSAmJiB0YXJnZXRDb2xsaXNpb24uc2l6ZSA9PT0gMCApIHtcclxuICAgIHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCAnY29sbGlkaW5nJyApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldENvbGxpc2lvbkNsYXNzZXMoIGNvbGxpc2lvblRyaWdnZXI6IENvbGxpc2lvblRyaWdnZXIsIHRhcmdldDogSFRNTEVsZW1lbnQgKSB7XHJcbiAgY29sbGlzaW9uVHJpZ2dlci50cmlnZ2VyRWxlbWVudC5jbGFzc0xpc3QuYWRkKCAnY29sbGlkaW5nJyApO1xyXG4gIHRhcmdldC5jbGFzc0xpc3QuYWRkKCAnY29sbGlkaW5nJyApO1xyXG59XHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gdHJpZ2dlckNvbGxpc2lvbkV2ZW50c0FzeW5jKCBjb2xsaXNpb25UcmlnZ2VyOiBDb2xsaXNpb25UcmlnZ2VyLCB0YXJnZXQ6IEhUTUxFbGVtZW50ICkge1xyXG4gIGNvbnN0IGNvbGxpZGluZ0F0ID0gZ2V0Q29sbGlzaW9uRGlyZWN0aW9uKCBjb2xsaXNpb25UcmlnZ2VyLnRyaWdnZXJFbGVtZW50LCB0YXJnZXQgKTtcclxuICBjb25zdCBkaXN0YW5jZUZyb21Cb3JkZXIgPSBnZXREaXN0YW5jZUZyb21Cb3JkZXIoIGNvbGxpc2lvblRyaWdnZXIudHJpZ2dlckVsZW1lbnQsIHRhcmdldCApO1xyXG4gIGF3YWl0IFByb21pc2UuYWxsKCBjb2xsaXNpb25UcmlnZ2VyLmV2ZW50cy5tYXAoIGFzeW5jIGV2ZW50ID0+IHtcclxuICAgIGF3YWl0IGV2ZW50Lm9uQ29sbGlkaW5nKFxyXG4gICAgICBjb2xsaXNpb25UcmlnZ2VyLnRyaWdnZXJFbGVtZW50LFxyXG4gICAgICB0YXJnZXQsXHJcbiAgICAgIGNvbGxpZGluZ0F0LFxyXG4gICAgICBkaXN0YW5jZUZyb21Cb3JkZXJcclxuICAgICk7XHJcbiAgfSApICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFRhcmdldENsYXNzZXNGb3JFdmVudHMoIGNvbGxpc2lvblRyaWdnZXJzOiBDb2xsaXNpb25UcmlnZ2VyW10sIGNvbGxpc2lvblRhcmdldFNlbGVjdG9yczogc3RyaW5nICk6IHZvaWQge1xyXG4gIGNvbnN0IGFyclRhcmdldHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCBjb2xsaXNpb25UYXJnZXRTZWxlY3RvcnMgKVxyXG5cclxuICBhcnJUYXJnZXRzLmZvckVhY2goIHRhcmdldCA9PiB7XHJcbiAgICBjb2xsaXNpb25UcmlnZ2Vycy5mb3JFYWNoKCBhZ2VudCA9PiB7XHJcbiAgICAgIGFnZW50LmV2ZW50cy5mb3JFYWNoKCAoIGUgKSA9PiB7XHJcbiAgICAgICAgaWYgKCBlLmF1dG9JbnNlcnRUYXJnZXRDbGFzcyApIHtcclxuICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKCBlLnRhcmdldENsYXNzICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IClcclxuICAgIH0gKTtcclxuICB9ICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFNldE9mRWxlbWVudHNDb2xsaWRpbmdXaXRoVGFyZ2V0cyggdGFyZ2V0OiBIVE1MRWxlbWVudCApOiBTZXQ8SFRNTEVsZW1lbnQ+IHtcclxuICBpZiAoICFtYXBFbGVtZW50c0NvbGxpZGluZ0J5VGFyZ2V0cy5oYXMoIHRhcmdldCApICkge1xyXG4gICAgbWFwRWxlbWVudHNDb2xsaWRpbmdCeVRhcmdldHMuc2V0KCB0YXJnZXQsIG5ldyBTZXQ8SFRNTEVsZW1lbnQ+KCkgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBtYXBFbGVtZW50c0NvbGxpZGluZ0J5VGFyZ2V0cy5nZXQoIHRhcmdldCApITtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U2V0T2ZFbGVtZW50c0NvbGxpZGluZ0J5VHJpZ2dlckVsZW1lbnQoIHRyaWdnZXJFbGVtZW50OiBIVE1MRWxlbWVudCApOiBTZXQ8SFRNTEVsZW1lbnQ+IHtcclxuICBpZiAoICFtYXBUYXJnZXRzQ29sbGlkaW5nQnlUcmlnZ2VyRWxlbWVudC5oYXMoIHRyaWdnZXJFbGVtZW50ICkgKSB7XHJcbiAgICBtYXBUYXJnZXRzQ29sbGlkaW5nQnlUcmlnZ2VyRWxlbWVudC5zZXQoIHRyaWdnZXJFbGVtZW50LCBuZXcgU2V0PEhUTUxFbGVtZW50PigpICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbWFwVGFyZ2V0c0NvbGxpZGluZ0J5VHJpZ2dlckVsZW1lbnQuZ2V0KCB0cmlnZ2VyRWxlbWVudCApITtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0Q29sbGlzaW9uQ2hlY2soKSB7XHJcbiAgY29sbGlzaW9uRXZlbnRzQnlTZWxlY3RvcnMuZm9yRWFjaCggKCBjb2xsaXNpb25UcmlnZ2VycywgY29sbGlzaW9uVGFyZ2V0U2VsZWN0b3JzICkgPT4ge1xyXG4gICAgc2V0VGFyZ2V0Q2xhc3Nlc0ZvckV2ZW50cyggY29sbGlzaW9uVHJpZ2dlcnMsIGNvbGxpc2lvblRhcmdldFNlbGVjdG9ycyApO1xyXG4gIH0gKTtcclxuXHJcbiAgY29sbGlzaW9uQ2hlY2tJbnRlcnZhbCA9IHNldEludGVydmFsKCAoKSA9PiB7XHJcbiAgICBjb2xsaXNpb25FdmVudHNCeVNlbGVjdG9ycy5mb3JFYWNoKCBhc3luYyAoIGNvbGxpc2lvblRyaWdnZXJzLCBjb2xsaXNpb25UYXJnZXRTZWxlY3RvcnMgKSA9PiB7XHJcbiAgICAgIGNvbnN0IGFyclRhcmdldHMgPSBBcnJheS5mcm9tKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCBjb2xsaXNpb25UYXJnZXRTZWxlY3RvcnMgKSApIGFzIEhUTUxFbGVtZW50W107XHJcblxyXG4gICAgICBzZXRDb2xsaXNpb25FdmVudHNGb3JUYXJnZXRzKCBhcnJUYXJnZXRzLCBjb2xsaXNpb25UcmlnZ2VycyApO1xyXG4gICAgfSApO1xyXG4gIH0sIDUwICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldENvbGxpc2lvbkV2ZW50c0ZvclRhcmdldHMoIGFyclRhcmdldHM6IEhUTUxFbGVtZW50W10sIGNvbGxpc2lvblRyaWdnZXJzOiBDb2xsaXNpb25UcmlnZ2VyW10gKSB7XHJcbiAgYXJyVGFyZ2V0cy5mb3JFYWNoKCBhc3luYyB0YXJnZXQgPT4ge1xyXG4gICAgY29uc3QgdGFyZ2V0Q29sbGlzaW9uU2V0OiBTZXQ8SFRNTEVsZW1lbnQ+ID0gZ2V0U2V0T2ZFbGVtZW50c0NvbGxpZGluZ1dpdGhUYXJnZXRzKCB0YXJnZXQgKTtcclxuXHJcbiAgICBjb2xsaXNpb25UcmlnZ2Vycy5mb3JFYWNoKCBhc3luYyB0cmlnZ2VyID0+IHtcclxuICAgICAgaWYgKCB0cmlnZ2VyLnRyaWdnZXJFbGVtZW50ID09PSB0YXJnZXQgKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB0cmlnZ2VyQ29sbGlzaW9uU2V0OiBTZXQ8SFRNTEVsZW1lbnQ+ID0gZ2V0U2V0T2ZFbGVtZW50c0NvbGxpZGluZ0J5VHJpZ2dlckVsZW1lbnQoIHRyaWdnZXIudHJpZ2dlckVsZW1lbnQgKTtcclxuXHJcbiAgICAgIGNvbnN0IGlzQ29sbGlzaW9uOiBib29sZWFuID0gY2hlY2tFbGVtZW50Q29sbGlzaW9uKCB0cmlnZ2VyLnRyaWdnZXJFbGVtZW50LCB0YXJnZXQgKTtcclxuXHJcbiAgICAgIGlmICggIWlzQ29sbGlzaW9uICkge1xyXG4gICAgICAgIGF3YWl0IG9uRWxlbWVudHNOb3RDb2xsaWRpbmcoIHRyaWdnZXJDb2xsaXNpb25TZXQsIHRhcmdldCwgdGFyZ2V0Q29sbGlzaW9uU2V0LCB0cmlnZ2VyICk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0cmlnZ2VyQ29sbGlzaW9uU2V0LmFkZCggdGFyZ2V0ICk7XHJcbiAgICAgIHRhcmdldENvbGxpc2lvblNldC5hZGQoIHRyaWdnZXIudHJpZ2dlckVsZW1lbnQgKTtcclxuXHJcbiAgICAgIHNldENvbGxpc2lvbkNsYXNzZXMoIHRyaWdnZXIsIHRhcmdldCApO1xyXG5cclxuICAgICAgYXdhaXQgdHJpZ2dlckNvbGxpc2lvbkV2ZW50c0FzeW5jKCB0cmlnZ2VyLCB0YXJnZXQgKTtcclxuICAgIH0gKTtcclxuICB9ICk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIG9uRWxlbWVudHNOb3RDb2xsaWRpbmcoIHRyaWdnZXJDb2xsaXNpb25TZXQ6IFNldDxIVE1MRWxlbWVudD4sIHRhcmdldDogSFRNTEVsZW1lbnQsIHRhcmdldENvbGxpc2lvblNldDogU2V0PEhUTUxFbGVtZW50PiwgdHJpZ2dlcjogQ29sbGlzaW9uVHJpZ2dlciApIHtcclxuICBjbGVhbk5vdENvbGxpZGluZ0VsZW1lbnRzQXR0cmlidXRlc0FuZENsYXNzZXMoXHJcbiAgICB0cmlnZ2VyQ29sbGlzaW9uU2V0LFxyXG4gICAgdGFyZ2V0LFxyXG4gICAgdGFyZ2V0Q29sbGlzaW9uU2V0LFxyXG4gICAgdHJpZ2dlclxyXG4gICk7XHJcblxyXG4gIGF3YWl0IFByb21pc2UuYWxsKCB0cmlnZ2VyLmV2ZW50cy5tYXAoIGFzeW5jIGV2ZW50ID0+IHtcclxuICAgIGF3YWl0IGV2ZW50Lm9uTm90Q29sbGlkaW5nKFxyXG4gICAgICB0cmlnZ2VyLnRyaWdnZXJFbGVtZW50LFxyXG4gICAgICB0YXJnZXRcclxuICAgICk7XHJcbiAgfSApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbml0Q29sbGlzaW9uQ2hlY2tPbiggZWxlbWVudFRvQ2hlY2s6IEhUTUxFbGVtZW50LCB0YXJnZXRRdWVyeVNlbGVjdG9yOiBzdHJpbmcsIGNvbGxpc2lvbkV2ZW50czogSUNvbGxpc2lvbkV2ZW50W10gKTogdm9pZCB7XHJcbiAgaW5zZXJ0SW50b0V2ZW50Q2hlY2tMaXN0KCBlbGVtZW50VG9DaGVjaywgdGFyZ2V0UXVlcnlTZWxlY3RvciwgY29sbGlzaW9uRXZlbnRzICk7XHJcblxyXG4gIGlmICggY29sbGlzaW9uQ2hlY2tJbnRlcnZhbCApIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHNldENvbGxpc2lvbkNoZWNrKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkVGFyZ2V0VG9UcmlnZ2VyRXZlbnQoIGN1cnJlbnRUYXJnZXQ6IEhUTUxFbGVtZW50LCB0YXJnZXRDbGFzc05hbWU6IHN0cmluZywgdmFsaWRhdGVEaXN0YW5jZT86IHsgZGlzdGFuY2VUaHJlc2hvbGQ6IG51bWJlciwgZGlzdGFuY2VGcm9tQm9yZGVyOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSB9ICk6IGJvb2xlYW4ge1xyXG4gIGlmICggIWN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCB0YXJnZXRDbGFzc05hbWUgKSApIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIGlmICggdmFsaWRhdGVEaXN0YW5jZSApIHtcclxuICAgIC8vLyBDaGVja3MgaG93IG1hbnkgcGl4ZWxzIHRoZSBkcmFnZ2FibGUgaXMgaW5zaWRlIGZyb20gZWFjaCBib3JkZXI7IGlmIHRoZSBlbGVtZW50IGlzIG92ZXIgdGhlIHRocmVzaG9sZCB0aGUgZnVuY3Rpb24gd2lsbCByZXR1cm4gdHJ1ZTtcclxuICAgIGNvbnN0IGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlRXh0cmFzID0gbmV3IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlRXh0cmFzKCB2YWxpZGF0ZURpc3RhbmNlLmRpc3RhbmNlRnJvbUJvcmRlciApO1xyXG4gICAgaWYgKCBjb2xsaXNpb25Cb3JkZXJEaXN0YW5jZUV4dHJhcy5hbnlMb3dlclRoYW4oIHZhbGlkYXRlRGlzdGFuY2UuZGlzdGFuY2VUaHJlc2hvbGQgKSApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50c0ludGVyYWN0aW5nU2V0KCB0YXJnZXQ6IEhUTUxFbGVtZW50ICk6IFNldDxIVE1MRWxlbWVudD4ge1xyXG4gIGlmICggIW1hcEVsZW1lbnRzVHJpZ2dlcmluZ0V2ZW50c0J5VGFyZ2V0LmhhcyggdGFyZ2V0ICkgKSB7XHJcbiAgICBtYXBFbGVtZW50c1RyaWdnZXJpbmdFdmVudHNCeVRhcmdldC5zZXQoIHRhcmdldCwgbmV3IFNldDxIVE1MRWxlbWVudD4oKSApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIG1hcEVsZW1lbnRzVHJpZ2dlcmluZ0V2ZW50c0J5VGFyZ2V0LmdldCggdGFyZ2V0ICkhO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJkaWN0S2V5c0J5QWN0aW9uIiwiTWFwIiwiY2hlY2tFbGVtZW50Q29sbGlzaW9uIiwiZWxlbWVudDEiLCJlbGVtZW50MiIsInJlY3QxIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwicmVjdDIiLCJ0b3AiLCJib3R0b20iLCJyaWdodCIsImxlZnQiLCJnZXRDb2xsaXNpb25EaXJlY3Rpb24iLCJkcmFnZ2FibGUiLCJ0YXJnZXQiLCJoZWlnaHQiLCJ3aWR0aCIsImNlbnRlciIsImdldERpc3RhbmNlRnJvbUJvcmRlciIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwYWlyIiwiY29kZSIsImZvckVhY2giLCJrYkV2ZW50IiwiQ09OVkVSU0lPTl9VTklUIiwiRElSRUNUSU9OX1JFRkVSRU5DRSIsIlZFUlRJQ0FMX1JFRkVSRU5DRSIsIkNPTE9SX0NIQU5ORUwiLCJDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZUV4dHJhcyIsImNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcyIsImNvbnN0cnVjdG9yIiwiY29sbGlzaW9uQm9yZGVyRGlzdGFuY2UiLCJ0aGlzIiwiYW55R3JlYXRlclRoYW4iLCJudW0iLCJhbnlMb3dlclRoYW4iLCJhbnlFcXVhbHMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsIm1hcEVsZW1lbnRzQ29sbGlkaW5nQnlUYXJnZXRzIiwibWFwVGFyZ2V0c0NvbGxpZGluZ0J5VHJpZ2dlckVsZW1lbnQiLCJtYXBFbGVtZW50c1RyaWdnZXJpbmdFdmVudHNCeVRhcmdldCIsImNvbGxpc2lvbkNoZWNrSW50ZXJ2YWwiLCJjb2xsaXNpb25FdmVudHNCeVNlbGVjdG9ycyIsImluc2VydEludG9FdmVudENoZWNrTGlzdCIsImVsZW1lbnRUb0NoZWNrIiwidGFyZ2V0UXVlcnlTZWxlY3RvciIsImNvbGxpc2lvbkV2ZW50cyIsInJlZkV4aXN0aW5nRXZlbnQiLCJwdXNoIiwidHJpZ2dlckVsZW1lbnQiLCJldmVudHMiLCJzZXQiLCJjbGVhbk5vdENvbGxpZGluZ0VsZW1lbnRzQXR0cmlidXRlc0FuZENsYXNzZXMiLCJ0cmlnZ2VyRWxlbWVudHNDb2xsaXNpb24iLCJ0YXJnZXRDb2xsaXNpb24iLCJhZ2VudCIsImRlbGV0ZSIsInNpemUiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzZXRDb2xsaXNpb25DbGFzc2VzIiwiY29sbGlzaW9uVHJpZ2dlciIsImFkZCIsImluaXRDb2xsaXNpb25DaGVja09uIiwiY29sbGlzaW9uVHJpZ2dlcnMiLCJjb2xsaXNpb25UYXJnZXRTZWxlY3RvcnMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlIiwiYXV0b0luc2VydFRhcmdldENsYXNzIiwidGFyZ2V0Q2xhc3MiLCJzZXRUYXJnZXRDbGFzc2VzRm9yRXZlbnRzIiwic2V0SW50ZXJ2YWwiLCJhc3luYyIsImFyclRhcmdldHMiLCJ0YXJnZXRDb2xsaXNpb25TZXQiLCJoYXMiLCJTZXQiLCJnZXRTZXRPZkVsZW1lbnRzQ29sbGlkaW5nV2l0aFRhcmdldHMiLCJ0cmlnZ2VyIiwidHJpZ2dlckNvbGxpc2lvblNldCIsImNvbGxpZGluZ0F0IiwiZGlzdGFuY2VGcm9tQm9yZGVyIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsImV2ZW50Iiwib25Db2xsaWRpbmciLCJ0cmlnZ2VyQ29sbGlzaW9uRXZlbnRzQXN5bmMiLCJvbk5vdENvbGxpZGluZyIsIm9uRWxlbWVudHNOb3RDb2xsaWRpbmciLCJzZXRDb2xsaXNpb25FdmVudHNGb3JUYXJnZXRzIiwiQXJyYXkiLCJmcm9tIiwiaXNWYWxpZFRhcmdldFRvVHJpZ2dlckV2ZW50IiwiY3VycmVudFRhcmdldCIsInRhcmdldENsYXNzTmFtZSIsInZhbGlkYXRlRGlzdGFuY2UiLCJjb250YWlucyIsImRpc3RhbmNlVGhyZXNob2xkIiwiZ2V0RWxlbWVudHNJbnRlcmFjdGluZ1NldCJdLCJzb3VyY2VSb290IjoiIn0=